<h1>实现躺赢，用AI+Rpa从小红书爬取笔记，自动提取内容，自动改成小绿书，并自动发布整体思路分享（附：RPA脚本）。</h1>
<blockquote>来源：<a href="https://b121w2zgwyx.feishu.cn/docx/GMDtddD10oQWlSxWUZEcuUFInof">https://b121w2zgwyx.feishu.cn/docx/GMDtddD10oQWlSxWUZEcuUFInof</a></blockquote>
<h1>背景说明</h1>
<p>小绿书最近很火，于是很多人就想到是不是可以直接搬运小红书的笔记来发呢？</p>
<p>但是有个问题，肯定不能完全一样的搬吧？</p>
<p>所以，就有人就提出是不是可以提取图片内容，进行修改然后替换背景图，改成小绿书呢？</p>
<p>当然可以！但是，这些操作，人工做起来还是相对繁琐的。</p>
<p>当然！目前，已经有很多大佬已经用AI+RPA实现了自动化了。包括我自己也整过影刀rpa的小绿书发布。从我自己的使用，以及交流群朋友的反馈来看。目前的AI+RPA工具，或多或少存在如下问题：</p>
<h1>目前的问题：</h1>
<p>1、rpa工具五花八门，对于不熟悉rpa的人，想用上工具，真的是九九八十一难。</p>
<p>2、有些工具封装的好，但内部流程我们看不到。当有些场景不适用的时候，自己想改又很难改。</p>
<p>3、当rpa操作的东西越多的时候，就越不稳定，只要链路上的某个软件做了调整，就有可能导致整体失败。</p>
<h1>优化与改进：</h1>
<p>为了解决以上问题，这一次的脚本思路我进行了以下优化：</p>
<p>1、尽量使用易分享的RPA，让大家在脚本的安装上更方便。</p>
<p>2、减少RPA工具调用的环节，能用接口就用接口。</p>
<p>3、工作流拆分零件化，让有需要修改需求的朋友，可以通过灵活替换节点，完成自己的迭代。</p>
<p>4、在使用上进行一定的封装，让即使不懂工作流的朋友，只要脚本跑通，也能正常用上功能</p>

<p>换句话话来说，小白有小白的用法，同时给予了已经上手的朋友，自我调整的空间。</p>
<p>废话不多说，老惯例，先来来看看这套脚本的展示：</p>
<p>接下来，我来分享一下整个脚本的思路，以及如何使用这套脚本</p>
<h1>一、整体流程思路</h1>
<p>1、使用rpa爬取小红书笔记，并将爬取内容存入到飞书。</p>
<p>2、coze工作流中，从飞书读取爬取的链接，进行ocr识别读取内容和修改，将修改后的内容，一键批量生成新的图片，最后录入到飞书的待发布文章中。</p>
<p>3、通过rpa触发coze工作流的自动执行。</p>
<p>4、rpa读取待发布文章，进行批量发布。</p>
<p>5、第4步的脚本，如果配合上 比特浏览器，就能实现多账号发布，并且还可ip隔离</p>
<p>6、所有脚本都设置成定时执行的话，就能实现整套流程自动化</p>
<h1>二、脚本工具环境配置</h1>
<h2>1、比特浏览器安装</h2>
<p>https://www.bitbrowser.cn/ 没什么特别说明的，直接安装就是了</p>
<h2>2、比特浏览器配置</h2>
<h3>①、打开比特浏览器，做个基础配置</h3>
<p>点击系统配置=》找到文件下载目录配置 改成你想要的目录</p>
<p><img src="img/b3acfaaa4a3d5ecd34b185fbebeab0d3.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/QEkQbaN8ZogxFhxavKicHRPonve/"/></p>
<p>这个目录是后面 小绿书的图片下载时要用到的。</p>
<h3>②、导入rpa脚本</h3>
<p>需要导入的三个脚本为</p>
<p>1、</p>
<p>2、</p>
<p>3、</p>
<p>分别下载以上三个脚本到本地。</p>
<p>然后, 打开比特浏览器=》 点击 “RPA自动化” =》进入流程设计</p>
<p><img src="img/d27ae6fa61461b248bf94ea0492a42f9.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/P8HSbAyfTojKMnxT5o2ciPlWnSc/"/></p>
<p>浏览器会初始化，并打开一个用于调试的RPA窗口，以及自带安装好的Automa 插件。</p>
<p><img src="img/73468a38b0a67ccf2032f25ce30786c0.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/WZxFbPUEzoeOVqxnrGecioBgn4f/"/></p>
<p>打开automa窗口，进入工作流页面=》点击下拉标志=》点击导入工作流，将前面下载的工作流导入</p>
<p><img src="img/bf20cd8c8298f135dc1bcf008123b3eb.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/MZBSb4XNxoVk4Kxab1nceW1Rnee/"/></p>
<h2>3、rpa配置</h2>
<h3>①、飞书账号以及链接的配置</h3>
<p>【飞书appid与appsecret的申请（重要！！）】</p>
<p>我的AI方案都是基于飞书做存储数据，所以飞书应用的建立是必须的。这一步如果配置不好，工具跑不通。请大家严格按照教程操作。</p>

<p>进入我的飞书表格</p>

<p>创建一下副本</p>
<p><img src="img/2803a9c077d4a284d60eda88dacfeeb6.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/EPm6bkmdRoiyGIxrAmPcZbwEn8e/"/></p>
<p>然后获取飞书表格链接，注意了，每个表单点击一下，链接都不一样的，后面的配置会用到，一定要对应正确的表格链接</p>
<p><img src="img/c0c10bbec599d3b289b2651fd78d00bd.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/RumgbSCjjoUHyNxJCahcbJ0Pn8f/"/></p>
<h3>②、脚本默认配置</h3>
<p>接下来，我们开始进行脚本的基本配置，每个脚本都要配置哦。我们首先打开比特浏览器=》 点击 “RPA自动化” =》进入流程设计。</p>
<p>然后进入工作流页面找到我们的刚刚导入的脚本，点击进入脚本编辑页面。找到触发器的后面一个节点叫做“插入数据”，我们双击“插入数据”，然后点击左边的 “insert data”按钮；</p>
<p><img src="img/0978a9a2bf0c639c92f57040b6b3f2d1.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/PjfbbsOZGo4aYgxMJ3cczN40nRf/"/></p>
<p>我们会看到这个配置页面，我们把这里里面的值，全部替换成我们自己的值就行了。切记变量名不要去修改，否则会出错</p>
<p><img src="img/dec4e543f501403c9d06ea45fde5c236.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/EppcbfbgPolaByxSHjEcTwtanBf/"/></p>
<p>字段对应如下，配置的时候注意对应清楚；</p>
<p>app_id  填你前面飞书得到的app_id;</p>
<p>app_secret 填你前面飞书得到的app_secret ;</p>
<p>daifabu_sheet_url 填你的飞书待发布表单的url（前面有说明过了）</p>
<p>yifabu_sheet_url 填你的飞书已发布表单的url</p>
<p>zhanhao_sheet_url 填你的飞书账号配置表单的url</p>
<p>sheet_url还有xhs_sheet_url  填你的飞书的小红书爬取表单的url</p>
<p>save_draft   这个填1 代表发布到草稿箱，填0代表直接发布（待测试完善）</p>
<p>download_path  这个填前面第2步，比特浏览器的下载目录就行了</p>
<p>is_bite  如果是其他浏览器或者在比特浏览器rpa调试时这里设置为0； 如果是正式绑定到窗口使用时，记得设置为1；</p>
<p>三个脚本都有这个默认配置项，记得修改！！</p>
<p>配置完成记得点击右上角的 保存！</p>
<p><img src="img/b9d9ca520f687048d7489b658f5aacdd.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/Ki5Obxi2Ho4aGqxd88bcI5CJnxb/"/></p>
<h2>4、将rpa配置到比特浏览器，以实现定时执行，和ip隔离。</h2>
<p>上面的配置完，其实直接运行就可以用了。不过为了实现多账号，以及定时执行，我们还需要将rpa脚本绑定到浏览器的窗口中。</p>
<h3>①、点击浏览器窗口=》创建窗口</h3>
<p><img src="img/32ef4b85db772a8d941f5e0ece848b54.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/Yk02bgxTZowEyvxHyg3cDfmrn5H/"/></p>
<h3>②、设置一下窗口名称，其他的用一键随机生成就行了</h3>
<p><img src="img/2069019af75e1ab3379a9b0dca7666ef.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/MyVQbfTvGoFc2Gx1OV9cLhGlnYf/"/></p>
<p>创建成功的话，这里会出现你命名的窗口</p>
<p><img src="img/f3e6b970d0f609e187050e06102c5329.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/JPTvbuNmEoOYhxxA5BIcJ9FYnKd/"/></p>
<p>这里的窗口，你们就理解成一台小电脑吧，他只运行了一个浏览器。 但是每个窗口可以有不同的ip地址，这样你如果有不同的账号，就能模拟出不同电脑登录的效果了。</p>
<p>因此，你要做几个账号，就创建几个窗口，然后将不同的微信在不同的窗口里面登录就行了。</p>
<h3>③、点击rpa自动化=》新建rpa任务</h3>
<p><img src="img/5fd434dec68bdb9232a322a6757b7283.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/SZdrbfBcdotIlkxwuOHcT5Banhb/"/></p>
<h3>④、填写任务名称，工作流ID，然后点击绑定：</h3>
<p><img src="img/8639131615f69f647abe74e073c91fbb.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/K291b6KJLoqy1ixDHyScejgsnkg/"/></p>
<h3>⑤、在弹出的绑定窗口中，选择你要绑定的窗口</h3>
<p><img src="img/33002eefbf56355e8adc45304dae02fa.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/Ncptb1YEzo8tQtxm3NRcZzXenlg/"/></p>
<p>脚本就绑定好了，其他脚本一样的操作，不过要注意，采集小红书的脚本，运行前有个输入参数要填，如果绑定到窗口执行会不方便。建议暂时不要绑定。除非你知道怎么优化脚本。</p>
<h3>⑥、两个脚本都绑定后，会出现如下页面</h3>
<p><img src="img/da7562cee733661c00c6b481cea353cc.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/M9ltbB4NSoUIpPxFVOIcc5qxnbe/"/></p>
<h3>⑦、这里提一下重点注意项</h3>
<p>以上绑定脚本时，有个工作流id是从这里复制的：</p>
<p><img src="img/583185d845dd0e7b11a52181fbecf831.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/I8J1bidPDovNLYxObUTcArclnZg/"/></p>
<p>绑定到默认的窗口后，从飞书发布到小绿书的脚本里面，有个保存资源的控件，默认没有写入下载目录的权限，我们要去修改一下。</p>
<p><img src="img/5568a90be5ec7d63610fdc95dcd1b2f2.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/KTcQbzaUponCOTxLUqGc0lcQnif/"/></p>

<p>到这里基本没什么问题了。开搞吧！！</p>
<h1>三、脚本问题说明</h1>
<p>目前，我这套流程，还是存在不少问题的，比如说，对于图文结合比较多的小红书笔记，例如这样子的：</p>
<p><img src="img/e3622a603bf8f1796b893952d79ffe17.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/JJkrbSFMwok8VJxUchfc0O4dnmf/"/></p>
<p><img src="img/99a04735bc87c9b5baa44ba0d1194bfd.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/D0lRbnyI6ojJ1CxF52GcRgaQnFb/"/></p>
<p>OCR能提取到内容，但是里面的内容是所有的拼凑在一起，无规律的 例如：</p>
<p><img src="img/abefe10a1d2734220c6102da2ddb10c0.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/CqYUbtsQYobW9Fxcj4Ec50ZFnFe/"/></p>
<p>虽然大模型可以根据语义，大致理解和修改出来。 但是很难还原出笔记原来的精髓！！我测试过，我目前的工作流这种改出来的基本不能用。期待有大佬能搞出更牛的方案</p>
<p>目前，图片只有干净背景，文本比较简洁的才容易转换成功，内容太多的也有可能导致，跟预设的模板不匹配的问题。</p>
<p>不过总体来说，总能挑出一些基本能用的拿来发了，比自己动手做强多了。</p>
<h1>四、常见问题</h1>
<h2>1、采集小红书运行成功，但没有录入到飞书。</h2>
<p>所有不能正常录入飞书的情况，99%是权限配置和表格没对应的问题，请先排查配置情况。我已经增加了一篇飞书的详细配置教程，自行参照操作：</p>

<h2>2、小绿书工作流触发脚本运行报错</h2>
<p>“很抱歉，同步失败。请检查网络连接是否正常，或者稍后再试。” 或者 运行中止 之类的。 只要脚本不是一运行就失败。而是转圈圈，转了很久才失败的话，基本是因为coze工作流的超时导致的。 但是，超时了，实际上飞书可以正常生成文章内容，大家检查飞书待发布表格是否有内容。有内容就忽略报错就好了。</p>
<h2>3、飞书发布小绿书脚本报错：Cannot read properties of undefined (reading '账号名称')</h2>
<p>还有类似的Cannot read properties of undefined (reading '标题') 。是因为读取的表格里没有内容。请先检查内容是否为空！或者待发布文章表格链接是否配置正确</p>
<h2>4、脚本运行无报错，但公众号没有执行发布</h2>
<p>账号配置里面有  领域和 类型， 只有当待发布的文章，领域跟类型跟账号配置的能对应上，才会发布。并且账号配置里的 账号名称 要跟公众号的名称一致才行。脚本靠名称识别是否发布。</p>
<h2>5、Mac电脑路径构造跟windows是不一样，请修改脚本里面 提取图片内容 代码块 的路径格式 </h2>
<h1>感谢</h1>
<p>感谢圈友@朱越的小绿书精华文，本文的脚本是参考了大佬分享的脚本改的！省了挺多事。</p>
