# CSDN 批量上传资源机器人-附完整代码截图

> 原文：[`www.yuque.com/for_lazy/zhoubao/izbrrzpbkpvb2nmp`](https://www.yuque.com/for_lazy/zhoubao/izbrrzpbkpvb2nmp)

## (22 赞)CSDN 批量上传资源机器人-附完整代码截图

作者： 码农飞哥|RPA 定制

日期：2024-05-21

大家好，我是码农飞哥。上市公司资深软件开发，CSDN 博客专家，擅长各类 RPA 机器人的开发，以及毕业设计的定制开发。

## 一、**业务场景：**

CSDN 上有个不同于其他博客平台的功能- 付费资源。也就是说开发者可以在 CSDN 上可以直接上传源代码，文档等付费资源供人下载。

但是上传一个资源需要挨个填写资源名称，资源描述，资源标签，价格等信息。

![CSDN 图片](img/a0a22323b29c7dbebca8aeaff12e8a1a.png "CSDN 图片")

当我们手头的资源比较多的时候，通过人工来一个个上传资源，修改资源的话费时费力又很低效。这时候我们就可以借助机器人来代替我们做这些重复的动作。

### 1、**演示视频**

## 二、使用手册

1、准备好需要上传的资源

2、在 Chrome 浏览器上打开批量上传的网页，并批量上传资源

[`mp.csdn.net/mp_download/creation/batchUploadV2?spm=1011.2124.3001.6137`](https://mp.csdn.net/mp_download/creation/batchUploadV2?spm=1011.2124.3001.6137)

2、在 Chrome 浏览器登录星火大模型

[`xinghuo.xfyun.cn/`](https://xinghuo.xfyun.cn/)

3、批量修改价格，资源标签等信息

4、运行影刀 RPA 应用

## 三、**程序运行流程：**

![img](img/00a78e3bf41cece60e7ff6a462617cab.png "img")

1、准备好需要上传的资源，将这些资源放在一个同一个目录下，以备后续使用。

2、在 Chrome 浏览器上登录 CSDN 平台，并打开批量上传资源的页面。

3、在 Chrome 浏览器上登录讯飞星火大模型

4、批量上传资源，等待资源上传完成

5、运行影刀 RPA 应用机器人

6、影刀 RPA 机器人会依次修改某个资源的资源描述。修改完成之后在发布资源。

## 四、**机器人代码解释**

### 1、**完整代码：**

![image-20240520092937009](img/cd045392459c3b8479faa723e829741b.png "image-20240520092937009")

2、**获取已打开的网页**

首先，第一步就是使用【获取已打开的网页对象】指令来实现获取批量上传资源页面。

![image-20240520093306066](img/be52141297bd6facae0325a92bd1857b.png "image-20240520093306066")

#### **3、循环所有资源**

![image-20240520093824539](img/351f2c32f37ac205830e835a4c4216fd.png "image-20240520093824539")

使用【循环相似元素】指令循环所有的编辑按钮。

### 4、循环体内操作

循环体内的操作主要是： 1\. 获取每一个动态元素，2\. 获取资源名称，3.根据资源名称结合提示词到星火生成资源简介

#### 4.1、获取元素信息

调用【获取元素信息】指令可以获取 资源名称 元素的 文本内容，也就是 资源名称。比如：springboot 二次元商品购物商城.zip。然后将获取到的文本内容保存到 web_element_attribute 变量中。

![image-20240520124706047](img/591cf746d3af035b2e6a2a36146a3a2a.png "image-20240520124706047")

![image-20240520124751300](img/5288ca2c112d93b2f2cf88a023d68bac.png "image-20240520124751300")

#### 4.2、生成资源简介

这里通过使用星火大模型来生成资源简介，使用星火的流程是： 新建会话====》输入提示词===》发送===》复制生成结果

*   1.

    新建会话

    通过使用【点击元素】指令新建会话，星火大模型有一个新建会话的按钮

![image-20240520125310364](img/f3fd1d0bd47ebd04fee3d4d2a36ca7be.png "image-20240520125310364")

*   1.

    输入提示词并发送给大模型

    在提示词输入框中使用【填写输入框】指令来输入提示词，web_element_attribute 变量就是前面捕获的资源名称。

![image-20240520125918167](img/6eafad3039eb454677668441b77ed6d2.png "image-20240520125918167")

这里使用的提示词比较简单，大家可以参考一下：

```
*   1.

    等待复制按钮出现

    通过【等待元素】指令 等待复制按钮出现，即当复制按钮出现的时候即认为本次回答已经生成完毕。

    ![image-20240520125817340](img/872a152f833385414ad54c64342f80c3.png "image-20240520125817340")
*   1.

    获取大模型生成的回答

    这里使用【获取元素信息】指令获取大模型生成的回答。操作目标是 回答文本框的 ，操作是 获取元素文本内容 。并将获取到的文本内容赋值给 生成的文档内容 变量里。![image-20240520130050070](img/4c38453a9d70846325e78155d4fc9019.png "image-20240520130050070")
*   1.

    将元素设置到剪切板中

    ![image-20240520130253032](img/0eaa7d1dc2df674da391a1fadb699844.png "image-20240520130253032")
*   1.

    填写输入框

    还是使用【填写输入框】指令 将 大模型生成的回答复制到资源简介输入框中。

    评论区：龙哥 : 牛逼

码农飞哥|RPA 定制 : [奋斗][奋斗]多在生财输出，生财星球不错![](img/21de372a77ea1f441c613f7316831ae1.png)
```