# 我用影刀rpa做了个多手机抖音自动发布机器人

> 来源：[https://ood4bblwty.feishu.cn/docx/GknKddubGoB4dXxbIKgc5psSnOC](https://ood4bblwty.feishu.cn/docx/GknKddubGoB4dXxbIKgc5psSnOC)

## 1、机器人介绍

*   我为什么要做这个机器人

*   公司的项目需要做矩阵，得在抖音的手机版上发布视频，一个人要管理20个手机，1个手机发布3个视频，也就是一天要发布60个抖音视频。这种耗时耗力的活儿当然是交给rpa干了。

*   该机器人能实现什么功能

*   多台安卓设备同时自动发布抖音视频

*   开始做机器人之前，你需要知道的事

*   手机的手势要设置为【全面屏手势】

*   影刀rpa目前只支持安卓手机，不支持苹果手机

*   连接测试时，每个手机都需要单独运行成功一遍

*   更新app后，app内的元素可能会变。所以机器人做好后，就把要禁止这个app的更新

*   该机器人效果，以一个手机为例（建议两倍数观看）：

## 2、做机器人的思路

### 2.1、让机器人在一台手机上可以正常运行

#### 2.1.1、连接手机

![](img/2aebbef4d0db18577b7706d65f4ba893.png)

#### 2.1.2、打开抖音app

![](img/009c008c8ef889389ad1210879fed417.png)

这里需要获取app包名，我们打开连接手机，在手机打开抖音app，点击获取包名即可

![](img/165a2bc349b5c22fdbd6cf64cb2357b1.png)

#### 2.1.3、进入抖音主页后，选择视频并发布。

因为抖音app的元素不是很稳定，这次能用的元素可能下次就不能用了。所以这里使用xpath来获取元素对象。

![](img/319f4072b87cbbf16bcf37c66ab06480.png)

元素特征一般来说，以 text 属性来定位，关注可以写作 //*[@text='关注']。如果不行，那就需要通过【获取手机ui树】来找到那个稳定不变的属性，然后替换text即可。比如id不变，就可以写作//*[@id='关注']。

具体操作：

![](img/cb59a41583c323c0085ba3714927a11c.png)

### 2.2、让机器人在多台手机上可以正常运行，提高流程的通用性

#### 2.2.1、连接手机选择【运行时的所有手机】

![](img/dcb5534a2cf8bbd5720ca2741121f5b6.png)

#### 2.2.2、通过【foreach列表循环】把每个手机对象拿出来

![](img/5d5673b62d62087b6c5f020fc6ab2101.png)

#### 2.2.3、在循环里调用2.1写的机器人，让每个手机按顺序运行

![](img/dbf3cf21f733be7bd8ee1ea3dcfd30b1.png)

#### 2.2.4、用【并发调用子流程】替换【调用流程】，让多个手机同时运行

![](img/09f06766730f3ea96e6301b3c7781853.png)

### 2.3、对固定错误进行处理，提高机器人的稳定性

#### 2.3.1、有时候抖音会弹出来我们上次没有发布视频的草稿，我们需要让机器人识别这种情况，然后关闭该页面，继续下面的流程。

打开抖音后，如果页面上有【关闭弹窗】元素，就关闭该元素，然后继续下一次循环。即发布视频

![](img/131041c57dd51152afcd62b2bacf0388.png)

### 2.4、对随机错误进行处理，提高机器人的稳定性

机器人运行过程中，可能会遇到各种随机错误，比如网络不佳，应用程序崩溃，人工误操作等等。我们要保证机器人遇到这些情况后，也能正常运行。

随机错误用try……catch……处理。如果可以正常运行，就和没有 try……catch……是一样的。

![](img/ad2c32c0de0c6a1e723d79a464047769.png)

具体操作：

![](img/040cb792ff9b5ec9de26472d1125cbaa.png)

## 3、具体流程展示

### 3.1、主流程

![](img/8c289ab7f0245f70abf297401e9f0675.png)

### 3.2、自动发布抖音视频

![](img/a5cf3e492219ffad6d828b4e1f66ffb7.png)

### 3.3、清空第一个应用程序，并返回主页

![](img/bf4dae426966645195bdf2542eaf6c1b.png)