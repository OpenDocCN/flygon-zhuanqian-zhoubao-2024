# 基于 ComfyUI 的模特与场景融合工作流介绍

> 原文：[`www.yuque.com/for_lazy/zhoubao/bymeh06el5pf7gs8`](https://www.yuque.com/for_lazy/zhoubao/bymeh06el5pf7gs8)

## (20 赞)基于 ComfyUI 的模特与场景融合工作流介绍

作者： 嘟嘟 MD🔫

日期：2024-12-16

# 一、介绍​

大家好，我是嘟嘟，目前专注于 ComfyUI 领域。

之前我分享过基于 Redux 的背景替换，那种是保持人物不变，背景换掉，不过那种方式打光效果不是很好，而且背景是风格迁移，不能很好固定，有时候我们需要固定一个参考的背景，这时候这套工作流就不适合了。​

​

今天我们换个思路，指定一个场景，把整个人都融入，完全重新生成，这种的优势是模特可以和场景很好的融合，很适合电商场景，就是已经有模特白底图了，要合成一个很好的场景中。​

​

核心还是利用 Fill+Redux，重点是思路的拆解。​

​

下面是跑的几张效果图，还是很不错的​

左一是模特图，中间是参考图（要涂抹遮罩），右边是最终的迁移图，把整个人迁移到新的图上。​

这样背景就是可控的，符合电商场景要求。

![ComfyUI_temp_znlhr_00004_.png](img/article-) images.zsxq.com/Fl0Yr5B61Hx4J4e0ciubNIwUtEKF)![ComfyUI_temp_rthio_00002_.png](img/article-) images.zsxq.com/lnk_5xiSF9GFMlIhtMlvvgP57ZMP)

# 二、工作流说明​

我们先来看下整体工作流

![output(9).png](img/FmsK-tWa3DUrt1897wpnKiyRq-) WK)

工作流一共分 5 个模块，核心用到的就 2 个。​

*   图片遮罩处理及拼接​

*   Fill+Redux 重绘迁移​

*   脸部修复​

*   SD 放大​

*   成品图拼接​

​

用户处理逻辑​

1：上传模特白底图​

2：上传要指定的场景图，手动涂抹要替换的区域（这个区域就是给模特预留的空间，融图进来）​

3：默认修脸和 SD 放大关闭，先跑图，抽出没问题的，再看情况去开启​

​

下面是按业务流程来介绍工作流​

​

## 2.1 图片遮罩处理及拼接

![output(10).png](img/article-) images.zsxq.com/Fljm9aileSA1E4OocNaMeAK3rKRi)

原理还是利用拼图的模式，把图片和遮罩都拼起来，这样提供给后期重绘的时候使用，拼接的图到时候重绘的时候一致性会大大提高。​

这里参考图的遮罩需要自己手动涂抹传入，其他不需要调整，图片最长边我设置了 1440，可以自己适当调整。

## 2.2 Fill+Redux 重绘迁移​

​![0152c712-8587-45ae-8d7a-52f1f65436c9.png](img/article-) images.zsxq.com/FoIA0XLED8aFI9k_bZ95IVzs5WH_)

​

这里就是利用 Fill+Redux 的三重迁移能力，生成后做裁剪，把右边区域的图片裁剪出来。​

固定这样不需要额外调整节点了。

## 2.3 脸部修复​

​

![a38b49b3-1b00-4372-94da-372d26445469.png](img/article-) images.zsxq.com/FpCjyAGrISsXhIr8gv03dw5fuc93)

​

该模块简单利用了 ReActor 的恢复面部模块，做适当的高清化，默认情况下不开启。​

替代方案是使用 Pulid 换脸，如果本身生成的挺清晰了，就不要用这个模块了。​

我测试下来发现修复后脸部变清晰了， 但是呢和原图就有点差异了。​

所以按需自己调整。​

## 2.4 高清 SD 放大​

​

![a7ae44d6-76ad-4639-b99e-9f7c2edd98a9.png](img/article-) images.zsxq.com/FuO6Y5c9KWwj8t_lOnUam4HvXtPM)

​

这里放大方案选择 SD 放大，如果原图足够高清，也不需要开启，放大倍数自己调整，默认设置 1.5 倍。​

提示词可写可不写，写的话可以更精细一些。​

​

# 三、总结​

以上就是这个电商模特场景融合工作流了，效果很不错，大家可以试试看。​

技术的迭代是飞快的，要关注最新的消息才不会掉队。​

关注我，每天分享最新的 ComfyUI 技术前沿。​

本篇中的工作流和模型打包好了。​

​

lib 也上线了线上版本，可在线运行！​

[`www.liblib.art/modelinfo/b3fa1096a63e41449582ecfc93ceb632`](https://www.liblib.art/modelinfo/b3fa1096a63e41449582ecfc93ceb632)​

​

工作流网盘地址: [`pan.quark.cn/s/37102485b9bd`](https://pan.quark.cn/s/37102485b9bd)

​

FLux 相关模型汇总：​

[`pan.quark.cn/s/d31efb33670f`](https://pan.quark.cn/s/d31efb33670f)

* * *

评论区：

刘卡卡 : 感谢分享