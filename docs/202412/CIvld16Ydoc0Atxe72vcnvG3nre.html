<h1>Youtubeè‡ªåŠ¨åŒ–å·¥å…·åˆ†äº« &amp; å¼€å‘å¤ç›˜</h1>
<blockquote>æ¥æºï¼š<a href="https://e6tnf5bko1.feishu.cn/docx/CIvld16Ydoc0Atxe72vcnvG3nre">https://e6tnf5bko1.feishu.cn/docx/CIvld16Ydoc0Atxe72vcnvG3nre</a></blockquote>
<p>å¤§å®¶å¥½å“‡ï¼Œæˆ‘æ˜¯é¾™~</p>

<p>åœ¨åšYoutube shortsçš„è¿‡ç¨‹ä¸­ï¼Œå¤§å®¶æˆ–å¤šæˆ–å°‘åº”è¯¥ä¼šé‡åˆ°ä»¥ä¸‹ä¸¤ç§æƒ…å†µï¼š</p>
<p>(1) è¦æ‰¾å¯¹æ ‡è´¦å·ï¼Œå¹¶ä¸”æ”¶é›†å¯¹æ ‡è´¦å·çš„æ•°æ®ï¼ˆè®¢é˜…æ•°ã€è§‚çœ‹æ•°ã€æ‰€åœ¨åœ°åŒºç­‰ï¼‰ï¼Œç”¨æ¥åˆ†æè¿™ä¸€èµ›é“æ˜¯å¦å¯ä»¥å…¥å±€</p>
<p>(2) ç¡®å®šå¯¹æ ‡è´¦å·ä¹‹åï¼Œè¦ä¸‹è½½å¯¹æ ‡è´¦å·çš„çˆ†æ¬¾è§†é¢‘ï¼Œåƒç´ çº§åˆ†æ+æ¨¡ä»¿</p>

<p>æˆ‘åœ¨åšYoutubeçš„æ—¶å€™ï¼Œä¹Ÿé‡åˆ°äº†è¿™ä¸¤ç§æƒ…å†µ</p>

<p>ä¸€å¼€å§‹ï¼Œæˆ‘éƒ½æ˜¯æ‰‹åŠ¨æ‰¾å¯¹æ ‡+æ”¶é›†å¯¹æ ‡æ•°æ®ï¼Œä¸€ä¸ªä¸ªå¤åˆ¶çˆ†æ¬¾è§†é¢‘çš„é“¾æ¥ï¼Œç„¶åå»åœ¨çº¿è§†é¢‘ç½‘ç«™ä¸‹è½½</p>

<p>æ•°é‡å°‘çš„æ—¶å€™ï¼Œè¿™äº›åŠ¨ä½œå¯èƒ½å½±å“ä¸å¤§ï¼Œä¸å¤ªèŠ±æ—¶é—´ï¼Œä¸€ä¼šå„¿å°±èƒ½å®Œæˆ</p>

<p>ä½†å¦‚æœå¯¹æ ‡è´¦å·æœ‰å‡ åä¸ªï¼Œè¦ä¸‹è½½çš„çˆ†æ¬¾è§†é¢‘æœ‰å‡ ç™¾ä¸ªï¼Œé‚£æ‰‹åŠ¨çš„æ–¹å¼æ˜¾ç„¶ä¸å¯è¡Œ</p>

<p>å¾€å°‘äº†ç®—ï¼Œæ”¶é›†ä¸€ä¸ªå¯¹æ ‡è´¦å·çš„æ•°æ®è¦ä¸€åˆ†é’Ÿï¼Œä¸‹è½½ä¸€ä¸ªçˆ†æ¬¾è§†é¢‘è¦ä¸€åˆ†é’Ÿï¼Œå‡ åå‡ ç™¾ä¸ªæ”¶é›†éœ€æ±‚å åŠ åˆ°ä¸€èµ·ï¼Œæˆ‘ä»¬å…‰æ”¶é›†æ•°æ®å’Œä¸‹è½½å¯¹æ ‡è§†é¢‘å°±å¾—ç”¨æ‰å¥½å‡ ä¸ªå°æ—¶ï¼Œè€Œä¸”éƒ½æ˜¯é‡å¤çš„åŠ¨ä½œï¼Œæ•ˆç‡å¤ªä½</p>

<p>ä¸ºäº†æé«˜æ•ˆç‡ï¼Œé’ˆå¯¹è¿™äº›éœ€è¦ï¼Œæˆ‘ç”¨cursorå¼€å‘äº†ä¸¤ä¸ªè‡ªåŠ¨åŒ–è½¯ä»¶ï¼Œè¿™é‡Œåˆ†äº«ç»™å¤§å®¶ï¼š</p>
<p>(1) Youtubeæ•°æ®é‡‡é›†å™¨ï¼šå¯ä»¥ç”¨Excelæ‰¹é‡å¯¼å…¥é¢‘é“ID/é¢‘é“URL/ç”¨æˆ·åï¼Œè‡ªåŠ¨é‡‡é›†é¢‘é“æ•°æ®åŠçˆ†æ¬¾è§†é¢‘æ•°æ®</p>
<p>(2) Youtubeæ‰¹é‡è§†é¢‘ä¸‹è½½å™¨ï¼šå¯ä»¥ç”¨Excelæ‰¹é‡å¯¼å…¥è§†é¢‘é“¾æ¥ï¼Œå®ç°å…¨è‡ªåŠ¨ä¸‹è½½</p>

<p>åºŸè¯ä¸å¤šè¯´ï¼Œä¸‹é¢ç»™å¤§å®¶åˆ†äº«è¿™ä¸¤ä¸ªå·¥å…·çš„å…·ä½“ä½¿ç”¨æ–¹æ³•~</p>

<p>è¿™ä¸¤ä¸ªè½¯ä»¶éƒ½æ˜¯åœ¨Windowsç³»ç»Ÿä¸Šé¢å¼€å‘çš„ï¼Œä¸ç¡®å®šMacç³»ç»Ÿæ˜¯å¦å¯ç”¨ï¼Œç”¨Macçš„åœˆå‹ä»¬å¯ä»¥å°è¯•ä¸‹</p>

<h1>å·¥å…·åŠŸèƒ½è¯´æ˜åŠæ•™ç¨‹</h1>
<h2>Youtubeæ•°æ®é‡‡é›†å™¨</h2>
<h3>åŠŸèƒ½è¯´æ˜</h3>
<p>Youtubeæ•°æ®é‡‡é›†å™¨çš„ç•Œé¢å¦‚ä¸‹ï¼š</p>
<p><img src="img/948cf89d6c5a63a9f24a942d4800815c.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/K7oobtKLIouUPexroORcBRFEn5L/"/></p>

<p>è¿™ä¸ªè½¯ä»¶çš„åŸç†ï¼š</p>
<p>è°ƒç”¨Youtubeå®˜æ–¹çš„APIæ¥æ”¶é›†é¢‘é“æ•°æ®å’Œè§†é¢‘æ•°æ®ï¼Œä½†æœ‰æ•°é¢é™åˆ¶</p>
<p>ï¼ˆæ¯å¤©é‡‡é›†å‡ åƒä¸ªé¢‘é“/è§†é¢‘æ•°æ®æ˜¯æ²¡å•¥é—®é¢˜çš„ï¼Œè‡ªå·±åšçš„è¯å¤Ÿç”¨äº†ï¼‰</p>

<p>è¿™ä¸ªè½¯ä»¶å¯ä»¥å®ç°ä»¥ä¸‹åŠŸèƒ½ï¼š</p>
<p>(1) æ”¯æŒç”¨Excelæ–‡ä»¶æ‰¹é‡å¯¼å…¥é¢‘é“ID/é¢‘é“URL/ç”¨æˆ·åï¼Œè‡ªåŠ¨é‡‡é›†è¯¥é¢‘é“çš„ä»¥ä¸‹ä¿¡æ¯ï¼š</p>
<p>é¢‘é“ç”¨æˆ·åã€é¢‘é“è¯´æ˜ã€é¢‘é“è®¢é˜…æ•°ã€é¢‘é“æ€»è§‚çœ‹æ•°ã€é¢‘é“æ€»è§†é¢‘æ•°é‡ã€é¢‘é“åˆ›å»ºæ—¶é—´ã€é¢‘é“æ‰€åœ¨åœ°åŒº</p>
<p><img src="img/bd710742ffe637820fea4d79308f0e01.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/VObAbIxgEoRKnaxuCPbc3McCnLd/"/></p>

<p>(2) åœ¨é‡‡é›†é¢‘é“æ•°æ®çš„åŸºç¡€ä¸Šï¼Œè¿›ä¸€æ­¥é‡‡é›†è§‚çœ‹é‡å¤§äºXï¼ˆå¯ä»¥è‡ªè¡Œè®¾å®šï¼‰çš„è§†é¢‘çš„ä»¥ä¸‹ä¿¡æ¯ï¼š</p>
<p>è§†é¢‘æ ‡é¢˜ã€è§†é¢‘è¯´æ˜ã€è§†é¢‘å‘å¸ƒæ—¶é—´ã€è§‚çœ‹é‡ã€ç‚¹èµæ•°ã€è¯„è®ºæ•°ã€æ ‡ç­¾ã€è§†é¢‘URLï¼ˆå³è§†é¢‘é“¾æ¥ï¼‰</p>
<p><img src="img/37d9b22ddd363862a4224200f98f0262.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/D0W1bpPVjoFCtwxzHRWcSchMnCb/"/></p>

<h3>ä½¿ç”¨å‰å‡†å¤‡</h3>
<p>ç”±äºè¿™ä¸ªè½¯ä»¶è°ƒç”¨äº†Youtubeçš„APIï¼Œä»¥åŠæˆ‘ä»¬æ˜¯ä¸­å›½å¤§é™†ç”¨æˆ·ï¼Œéœ€è¦é­”æ³•æ‰èƒ½é‡‡é›†æ•°æ®</p>

<p>å› æ­¤ï¼Œåœ¨ä½¿ç”¨è¿™ä¸ªè½¯ä»¶ä¹‹å‰ï¼Œéœ€è¦è¿›è¡Œä»¥ä¸‹å‡†å¤‡</p>

<h4>ç¬¬ä¸€æ­¥ï¼Œæ‰“å¼€é­”æ³•</h4>
<p>è¦æ‰“å¼€é­”æ³•ä¹‹åè¿è¡Œè¿™ä¸ªè½¯ä»¶ï¼Œæ‰èƒ½æˆåŠŸé‡‡é›†ï¼Œä½†è¿™ä¸ªä¸æ–¹ä¾¿å…¬å¼€åˆ†äº«ï¼Œå¤§å®¶è‡ªè¡Œæ·˜å®</p>
<p>è®°å¾—ä¸€å®šè¦æ‰“å¼€ï¼ï¼ï¼</p>

<h4>ã€é‡ç‚¹ã€‘ç¬¬äºŒæ­¥ï¼Œè·å–ä½ çš„Youtube API Key</h4>

<p>åŸå§‹æ•™ç¨‹æ¥è‡ªäº é©¬å“¥@è€é¦¬ğŸå†…å®¹å‡ºæµ· çš„å¸–å­ï¼š</p>

<p>é¦–å…ˆï¼Œæˆ‘ä»¬æ‰“å¼€é­”æ³•ï¼ˆä¸æ–¹ä¾¿å…¬å¼€åˆ†äº«ï¼Œå¤§å®¶è‡ªè¡Œæ·˜å®ï¼‰ï¼Œè¿›å…¥è¿™ä¸ªç½‘ç«™ï¼šhttps://console.cloud.google.com/</p>

<p>ç„¶åï¼Œé€‰æ‹©â€œAPIå’ŒæœåŠ¡â€</p>
<p><img src="img/ff82c74ca18b82eff11a84e9030fe6cf.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/OamLbUDR7opueVxVE6OcWbLcn2d/"/></p>

<p>æ¥ç€ï¼Œç‚¹å‡»â€œå¯ç”¨APIå’ŒæœåŠ¡â€</p>
<p><img src="img/1269fb5649c1807066ee021909c6fa68.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/EhVSbATlGo3BY1xIvBlceunUnWg/"/></p>

<p>ä¸‹ä¸€æ­¥ï¼Œåœ¨æœç´¢æ¡†è¾“å…¥â€œYoutubeâ€ï¼Œç‚¹å‡»Enter</p>
<p><img src="img/d75cd0811c597425768f8afe03ff94bb.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/MaZVbRyrzoNQNTxGfM5csCIFnkd/"/></p>

<p>å†ç„¶åï¼Œé€‰æ‹©ç¬¬ä¸€ä¸ªï¼Œâ€œYouTube Data API v3â€</p>
<p><img src="img/a6d5f62b0876225f4e07bb95b50b3797.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/Mo6ibeGf4odED6xpJN2c9HsMnGe/"/></p>

<p>ç‚¹å‡»â€œå¯åŠ¨â€ï¼Œä¹‹åä¼šæ˜¾ç¤ºâ€œAPIå·²å¯ç”¨â€</p>
<p><img src="img/89bde2f9b0a4bca889c76ae411469c0b.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/OkxIbd8dco7LhfxCsZdc7cZLnSe/"/></p>

<p>ç‚¹å‡»â€œç®¡ç†â€ï¼Œè¿›å…¥ä¸‹ä¸€ä¸ªç•Œé¢åï¼Œåœ¨å·¦ä¾§ç‚¹å‡»â€œå‡­æ®â€</p>
<p><img src="img/e59cf982a48af64477de11677bd194a1.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/JD3Pbhxp0oKRfZxeAhwcuk38nCz/"/></p>

<p><img src="img/d39d75cc06e0badaa70d8c0679dc91c2.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/FzLAbTka7oGewDxHleVcqx4jnEw/"/></p>


<p>åœ¨ä¸Šæ–¹ç‚¹å‡»â€œåˆ›å»ºå‡­æ®â€ï¼Œé€‰æ‹©â€œAPIå¯†é’¥â€</p>
<p><img src="img/142b3b52e7c87a7555746f530391e133.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/RN0fbxECbopn4Gx7CP8cTSjJnih/"/></p>

<p><img src="img/cd0f619482a97f7f96d7e07ac09cec16.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/XYnHbbgd0o9zPjxKlCmcdB2onse/"/></p>

<p>åˆ›å»ºå®Œæˆä¹‹åï¼Œç‚¹å‡»â€œæ˜¾ç¤ºå¯†é’¥â€ï¼Œç„¶åå¤åˆ¶é‡Œé¢çš„ä¸€å¤§ä¸²å³å¯</p>
<p><img src="img/bf2c57ba1d329d9a01d5305ff85d6862.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/QZcQbrryyojcljxwTouchepfnEh/"/></p>

<p><img src="img/309affa410e0bdcc9833b45c0de4ab1a.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/Z9gDbXpfZoqL5Ax2PyXc5momnSF/"/></p>

<p>å¤åˆ¶å®Œæˆä¹‹åï¼Œè¿›å…¥æˆ‘ä»¬çš„è½¯ä»¶ï¼ŒæŠŠè¿™ä¸²å¯†é’¥ç²˜è´´åœ¨â€œYouTube API Keyâ€è¿™ä¸€æ ï¼Œé€‰æ‹©â€œä¿å­˜â€</p>
<p>ï¼ˆä¸ä¿å­˜çš„è¯ï¼Œä¸‹ä¸€æ¬¡è¿›è¡Œè½¯ä»¶å°±éœ€è¦é‡æ–°è¾“å…¥è¿™ä¸²å¯†é’¥ï¼Œç‚¹å‡»â€œä¿å­˜â€ï¼Œè¿™ä¸²å¯†é’¥å°±ä¼šä¸€ç›´ä½¿ç”¨ï¼‰</p>
<p><img src="img/b18ca715e6e80a7e493f144c31ec18d1.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/Ga1SbX853obYdkxb2lRcoQLYnfd/"/></p>

<h4>ã€é‡ç‚¹ã€‘ç¬¬ä¸‰æ­¥ï¼Œè·å–ä½ çš„ä»£ç†ç«¯å£åœ°å€</h4>
<p>ç”±äºæˆ‘ä»¬åœ¨å›½å†…ï¼Œæˆ‘ä»¬è¿˜éœ€è¦æ‹¿åˆ°å¼€çš„é­”æ³•çš„ç«¯å£åœ°å€ï¼Œæ‰èƒ½è®©è½¯ä»¶å‡ºå»é‡‡é›†æ•°æ®</p>

<p>è¿™ä¸€æ­¥æˆ‘ä»¬å¯ä»¥ç”¨åˆ°chatGPT</p>

<p>è¿›å…¥chatGPTå®˜ç½‘ï¼Œè¾“å…¥ä»¥ä¸‹æç¤ºè¯ï¼š</p>
<p>æˆ‘ä½¿ç”¨çš„ä»£ç†è½¯ä»¶æ˜¯ï¼ˆè¾“å…¥ä½ è‡ªå·±ç”¨çš„ä»£ç†è½¯ä»¶åç§°ï¼‰ï¼Œæˆ‘è¯¥å¦‚ä½•æŸ¥çœ‹æˆ‘çš„ä»£ç†ç«¯å£åœ°å€ï¼Œæˆ‘ä¸ç†Ÿæ‚‰è¿™ä¸ªä»£ç†è½¯ä»¶ï¼Œè¯·ä½ ä¸€æ­¥æ­¥æŒ‡å¯¼æˆ‘æŸ¥çœ‹ä»£ç†ç«¯å£åœ°å€</p>

<p>è¿™ä¸ªè¿‡ç¨‹ä¸­å¦‚æœGPTè®©ä½ æä¾›ç•Œé¢å›¾ç‰‡ä»€ä¹ˆçš„ï¼Œä½ å°±æˆªå›¾ç»™å®ƒï¼Œå®ƒä¼šæŒ‡å¯¼ä½ æ‰¾åˆ°ç«¯å£åœ°å€</p>
<p><img src="img/6af1d9b05577ecf5fd5f578d5af48199.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/WwphbEyjvokoFLxjWJEcVleUnS6/"/></p>
<p>æ³¨æ„ï¼š</p>
<p>ä¸åŒçš„è½¯ä»¶çš„ä»£ç†ç«¯å£åœ°å€ä¸ä¸€æ ·ï¼Œå¤§å®¶ä¸è¦ç…§æŠ„æˆ‘çš„ï¼Œç…§æŠ„æˆ‘çš„å¾ˆå¯èƒ½ä¼šæŠ¥é”™ï¼ï¼ï¼</p>
<p>æƒ³æ‰¾åˆ°è‡ªå·±çš„ä»£ç†ç«¯å£åœ°å€ï¼Œåƒæˆ‘è¿™æ ·é—®GPTå°±å¯ä»¥</p>

<p>æ‹¿åˆ°ä»£ç†ç«¯å£åœ°å€ä¹‹åï¼Œä¹Ÿæ˜¯åŒæ ·æ‰“å¼€è½¯ä»¶ï¼Œåœ¨â€œä»£ç†åœ°å€â€ä¸€æ è¾“å…¥å¹¶ä¿å­˜</p>
<p><img src="img/573a1644fcd1c6431269cab2e6681024.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/McUbbIzDoo3GegxUxEacsLQAnFb/"/></p>

<h4>ç¬¬å››æ­¥ï¼Œå‡†å¤‡ä¸€ä¸ªæä¾›é¢‘é“ID/é¢‘é“URL/ç”¨æˆ·åçš„Excelæ–‡ä»¶</h4>
<p>è¿™ä¸ªè½¯ä»¶æ”¯æŒä»¥ä¸‹ä¸‰ç§æ ¼å¼æ¥è¾“å…¥é¢‘é“ï¼š</p>
<p>â‘ é¢‘é“IDï¼šUC-PzuWWwlOMynKP7w2BvM6gï¼ˆä»¥UCå¼€å¤´ï¼‰ï¼Œå¯ä»¥æŒ‰ä¸‹å›¾çš„æ–¹å¼è·å–</p>
<p><img src="img/339f24c5301255a9f1d4559b042591e4.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/RDuBbgA8VoKyGTxXpCmcTsBVnMc/"/></p>

<p>â‘¡é¢‘é“URLï¼šhttps://www.youtube.com/@CalmCity-channelï¼Œæ ¼å¼ä¸ºâ€œhttps://www.youtube.com/@usernameâ€</p>
<p>å¯ä»¥æŒ‰ä¸‹å›¾æ–¹å¼è·å–</p>
<p><img src="img/dbb01a5cb4287f6a062d78f98b65f679.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/TnrEbq45GoTEvox6iwcctYmdnRd/"/></p>

<p><img src="img/6fb74a4b45c64941e599717350054f28.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/K1mcbLB9qoNtjExLLhkc8yzknwh/"/></p>

<p>â‘¢ç”¨æˆ·åï¼š@CalmCity-channelï¼Œæ ¼å¼ä¸ºâ€œ@usernameâ€ï¼Œå¯ä»¥æŒ‰ä¸‹å›¾æ–¹å¼è·å–</p>
<p><img src="img/b3af59f29c8882467c1bb0de64d9761f.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/OwN5bskGko3vobxhoAUcJKKenzf/"/></p>

<p>è¿™ä¸‰ç§æ–¹å¼ä¸­ï¼Œé¢‘é“IDï¼ˆUCå¼€å¤´ï¼‰æœ€ç²¾ç¡®ï¼Œä½†ä¸å¥½è·å–ï¼›é¢‘é“URLæ¯”è¾ƒå¸¸ç”¨ï¼Œç²¾ç¡®åº¦ä¸€èˆ¬æƒ…å†µä¸‹éƒ½å¤Ÿç”¨ï¼›ç”¨æˆ·åæœ€æ–¹ä¾¿ï¼Œä½†æ˜¯ç²¾ç¡®åº¦æœ€å·®ã€‚é¦–æ¨é¢‘é“URLå’Œé¢‘é“IDè¿™ä¸¤ç§æ ¼å¼</p>

<p>è¯´æ˜ï¼š</p>
<p>æˆ‘åœ¨æ”¶é›†https://www.youtube.com/@HealingWithMe.è¿™ä¸ªé¢‘é“çš„æ•°æ®æ—¶ï¼Œç”±äºç”¨çš„æ˜¯URLæ ¼å¼ï¼Œå¹¶ä¸”è¿˜æœ‰å…¶ä»–é¢‘é“çš„URLå’Œè¿™ä¸ªé¢‘é“éå¸¸åƒï¼Œæ‰€ä»¥å¯¼è‡´ä¸€ç›´æ”¶é›†ä¸åˆ°æ­£ç¡®çš„æ•°æ®ï¼Œæœ€åæ˜¯ç”¨äº†é¢‘é“IDçš„æ–¹æ³•æ‰é‡‡é›†åˆ°æ­£ç¡®çš„æ•°æ®ï¼Œä½†è¿™ç§æƒ…å†µå¾ˆå°‘å‡ºç°ï¼ˆè¿™ä¸ªé¢‘é“æ¯”è¾ƒç‰¹æ®Šï¼Œå®ƒçš„URLæœ€åæœ‰ä¸ª"."å·ï¼Œå¯¼è‡´ç¨‹åºè¯†åˆ«å®¹æ˜“å‡ºé—®é¢˜ï¼‰ï¼Œæ‰€ä»¥ï¼Œå¦‚æœå¤§å®¶è¿½æ±‚ç»å¯¹ç²¾ç¡®ï¼Œå°±ç”¨é¢‘é“IDï¼Œä½†å¤§å¤šæ•°æƒ…å†µä¸‹é¢‘é“URLä¹Ÿå¤Ÿç”¨</p>


<p>æ”¶é›†å¥½å¯¹åº”æ ¼å¼çš„é¢‘é“é“¾æ¥ä¹‹åï¼Œæ”¾è¿›ä¸€ä¸ªExcelæ–‡ä»¶é‡Œã€‚Excelæ–‡ä»¶çš„æ ¼å¼å¦‚ä¸‹å›¾ï¼Œé¢‘é“é“¾æ¥æ”¾åœ¨ç¬¬ä¸€åˆ—ï¼Œæˆ‘æ ‡é»„çš„é‚£ä¸ªæ ¼å­ä¸è¦æ”¾ï¼Œç¨‹åºè¯†åˆ«ä¸å‡ºæ¥ï¼Œé‚£ä¸ªæ ¼å­å†™ä¸å†™ä¸œè¥¿éƒ½æ— æ‰€è°“</p>
<p><img src="img/fa8a09ac5958bc36ef6e99246d7e7554.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/BxhFbg5qMoKBW6xp8mxctsU0njf/"/></p>

<h3>ä½¿ç”¨æŒ‡å¼•</h3>
<p>å®Œæˆä»¥ä¸Šå‡†å¤‡ä¹‹åï¼Œå°±æ‰“å¼€è½¯ä»¶</p>

<p>â‘  è¾“å…¥API Keyï¼ˆå¹¶ä¿å­˜ï¼‰</p>
<p><img src="img/f56acad80497efac44f5fab0fdb5f8f3.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/JYoGbOMAKo6wtcx3rEYcM3SSnad/"/></p>

<p>â‘¡ è¾“å…¥ä»£ç†åœ°å€ï¼ˆå¹¶ä¿å­˜ï¼‰</p>
<p><img src="img/ee444cc0637644beef69b6cb91a75a96.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/CYD9bP4qno0va0xaGaucJMREnvf/"/></p>

<p>â‘¢ è®¾å®šæƒ³è¦æ”¶é›†çš„è§†é¢‘æ•°æ®ä¸‹é™ï¼ˆç¨‹åºåªä¼šæ”¶é›†å¤§äºä½ è®¾å®šçš„è§‚çœ‹é‡çš„è§†é¢‘ä¿¡æ¯ï¼‰</p>
<p><img src="img/606154a61645a91a3b34ba6689a24513.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/Y1GMbxlrhopfZLxFUbLcpbNgnNc/"/></p>

<p>â‘£ é€‰æ‹©Excelæ–‡ä»¶æ‰€åœ¨çš„è·¯å¾„</p>
<p><img src="img/298e98d6994dcb01485b9e874a8152c2.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/IzAJbhomQo0pDCxe78ZcPy1lnjg/"/></p>

<p>â‘¤ é€‰æ‹©æ”¶é›†å¥½çš„è§†é¢‘ä¿¡æ¯çš„ä¿å­˜è·¯å¾„ï¼ˆæ”¶é›†çš„è§†é¢‘ä¿¡æ¯ä¼šä»¥Excelæ–‡ä»¶çš„å½¢å¼ä¿å­˜ï¼‰</p>
<p><img src="img/9ee972ac53192c556f85f485ce7f7b1a.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/Bpz0biqyNoAntBxZx3EcHfJinUc/"/></p>

<p>â‘¥ ç‚¹å‡»â€œå¼€å§‹é‡‡é›†â€ï¼Œé‡‡é›†è¿‡ç¨‹ä¸­çš„æ•°æ®ä¹Ÿä¼šæ˜¾ç¤ºåœ¨è½¯ä»¶ä¸Š</p>
<p>ï¼ˆå¦‚ï¼šæœ€åä¸€å…±é‡‡é›†äº†å¤šå°‘ä¸ªç¬¦åˆè¦æ±‚çš„è§†é¢‘ã€æ–‡ä»¶ä¿æŒä½ç½®ç­‰ï¼‰</p>
<p><img src="img/ec90b0918d8d2c0212b3a81e3d7b6485.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/QT7Rbfg3doX5IhxpA3scT2Gsnld/"/></p>

<p>æ³¨æ„ï¼š</p>
<p>æ”¶é›†çš„é¢‘é“æ•°æ®ä¼šä¿å­˜åœ¨ä½ æä¾›é¢‘é“é“¾æ¥çš„Excelæ–‡ä»¶æ‰€åœ¨çš„ä½ç½®ï¼Œè€Œè§†é¢‘æ•°æ®åˆ™ä¼šä¿å­˜åœ¨ä½ é€‰æ‹©çš„ä¿å­˜è·¯å¾„ä¸­</p>

<p>é¢‘é“æ•°æ®ä¿å­˜ç¤ºä¾‹ï¼ˆæ–‡ä»¶å‘½åï¼šchannel_updated_å…·ä½“æ”¶é›†æ—¶é—´ å¹´æœˆæ—¥æ—¶åˆ†ç§’ï¼‰ï¼š</p>
<p><img src="img/8d64aa2055916e77bd0b9366a28a4092.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/HGPHbjp30ooDU9xET8ccpbsAnVd/"/></p>

<p>è§†é¢‘æ•°æ®ä¿å­˜ç¤ºä¾‹ï¼ˆæ–‡ä»¶å‘½åï¼š@ç”¨æˆ·å_videoï¼‰ï¼š</p>
<p><img src="img/07b89a8e40bd45cee5c9efabda1d706c.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/WBoRbvom8opBcrxTBybcrupJnAg/"/></p>

<h3>è½¯ä»¶åœ°å€</h3>
<p>é€šè¿‡ç™¾åº¦ç½‘ç›˜åˆ†äº«çš„æ–‡ä»¶ï¼šYoutubeæ•°æ®é‡‡é›†å™¨ 2.0.zip</p>
<p>é“¾æ¥ï¼šhttps://pan.baidu.com/s/1PNbXdqmZPrjzQLi2cUYMUA?pwd=v8dk</p>
<p>æå–ç ï¼šv8dk</p>

<h3>æºä»£ç </h3>
<h4>ä¸»ç¨‹åº</h4>
<pre>import os
import logging
from datetime import datetime
import pandas as pd
from googleapiclient.discovery import build
from tenacity import retry, stop_after_attempt, wait_exponential


class YouTubeDataCollector:
    def __init__(self, api_key, view_threshold=1000000, proxy=None, save_path=None, logger_callback=None):
        """
        åˆå§‹åŒ–æ”¶é›†å™¨
        :param api_key: YouTube APIå¯†é’¥
        :param view_threshold: è§†é¢‘è§‚çœ‹é‡é˜ˆå€¼
        :param proxy: ä»£ç†è®¾ç½®
        :param save_path: æ•°æ®ä¿å­˜è·¯å¾„
        :param logger_callback: æ—¥å¿—å›è°ƒå‡½æ•°
        """
        # é…ç½®ä»£ç†
        if proxy:
            os.environ['HTTP_PROXY'] = proxy
            os.environ['HTTPS_PROXY'] = proxy

        self.api_key = api_key
        self.youtube = build('youtube', 'v3', developerKey=api_key)
        self.logger_callback = logger_callback
        self.view_threshold = view_threshold  # è®¾ç½®è§‚çœ‹é‡é˜ˆå€¼

        # éªŒè¯å¹¶è®¾ç½®ä¿å­˜è·¯å¾„
        if not save_path:
            raise ValueError("å¿…é¡»æŒ‡å®šä¿å­˜è·¯å¾„")
        self.video_save_path = save_path

        # è®¾ç½®æ—¥å¿—è·¯å¾„ä¸ºä¿å­˜è·¯å¾„ä¸‹çš„ logs æ–‡ä»¶å¤¹
        self.log_path = os.path.join(self.video_save_path, "logs")

        # é…ç½®æ—¥å¿—
        self.setup_logging()

    def setup_logging(self):
        """è®¾ç½®æ—¥å¿—"""
        # åˆ›å»ºæ—¥å¿—ç›®å½•
        os.makedirs(self.log_path, exist_ok=True)
        log_file = os.path.join(self.log_path, f'youtube_collector_{datetime.now().strftime("%Y%m%d")}.log')

        logging.basicConfig(
            level=logging.INFO,
            format='%(asctime)s - %(levelname)s - %(message)s',
            handlers=[
                logging.FileHandler(log_file, encoding='utf-8'),
                logging.StreamHandler()
            ]
        )
        self.logger = logging.getLogger(__name__)

    def log_message(self, message):
        """ç»Ÿä¸€çš„æ—¥å¿—è®°å½•å‡½æ•°"""
        self.logger.info(message)
        if self.logger_callback:
            self.logger_callback(message)

    def extract_channel_info(self, input_str):
        """
        ä»å¤šç§è¾“å…¥æ ¼å¼ä¸­æå–é¢‘é“ä¿¡æ¯
        æ”¯æŒçš„æ ¼å¼ï¼š
        1. é¢‘é“ID (UC...)
        2. é¢‘é“URL (https://www.youtube.com/@...)
        3. é¢‘é“ç”¨æˆ·å (@...)
        """
        try:
            self.log_message(f"æ­£åœ¨å¤„ç†è¾“å…¥: {input_str}")

            # 1. æ£€æŸ¥æ˜¯å¦æ˜¯é¢‘é“ID (UCå¼€å¤´)
            if input_str.startswith('UC'):
                self.log_message("æ£€æµ‹åˆ°é¢‘é“IDæ ¼å¼")
                return self.get_channel_by_id(input_str)

            # 2. æ£€æŸ¥æ˜¯å¦æ˜¯é¢‘é“URLæˆ–ç”¨æˆ·å
            if '/@' in input_str or input_str.startswith('@'):
                self.log_message("æ£€æµ‹åˆ°é¢‘é“ç”¨æˆ·åæ ¼å¼")
                username = input_str.split('/@')[-1].split('/')[0].strip() if '/@' in input_str else input_str.strip()
                return self.get_channel_by_username(username)

            self.log_message(f"æ— æ³•è¯†åˆ«çš„è¾“å…¥æ ¼å¼: {input_str}")
            return None

        except Exception as e:
            self.log_message(f"æå–é¢‘é“ä¿¡æ¯æ—¶å‡ºé”™: {str(e)}")
            return None

    def get_channel_by_id(self, channel_id):
        """ç›´æ¥é€šè¿‡é¢‘é“IDè·å–ä¿¡æ¯"""
        try:
            request = self.youtube.channels().list(
                part="snippet,statistics,brandingSettings",
                id=channel_id
            )
            response = request.execute()

            if response.get('items'):
                channel = response['items'][0]
                self.log_message(f"æˆåŠŸè·å–é¢‘é“ä¿¡æ¯: {channel['snippet']['title']}")
                return channel
            else:
                self.log_message(f"æœªæ‰¾åˆ°é¢‘é“ID: {channel_id}")
                return None

        except Exception as e:
            self.log_message(f"è·å–é¢‘é“ä¿¡æ¯æ—¶å‡ºé”™: {str(e)}")
            return None

    def get_channel_by_username(self, username):
        """é€šè¿‡ç”¨æˆ·åè·å–é¢‘é“ä¿¡æ¯"""
        try:
            # ç§»é™¤@ç¬¦å·ï¼ˆå¦‚æœå­˜åœ¨ï¼‰
            clean_username = username.lstrip('@')
            self.log_message(f"æ­£åœ¨è·å–é¢‘é“ä¿¡æ¯ï¼Œç”¨æˆ·å: {clean_username}")

            # ä½¿ç”¨æœç´¢æ–¹æ³•æŸ¥æ‰¾é¢‘é“
            try:
                request = self.youtube.search().list(
                    part="snippet",
                    q=clean_username,
                    type="channel",
                    maxResults=5
                )
                response = request.execute()

                if response.get('items'):
                    # è·å–ç¬¬ä¸€ä¸ªæœç´¢ç»“æœçš„é¢‘é“ID
                    channel_id = response['items'][0]['id']['channelId']

                    # ä½¿ç”¨é¢‘é“IDè·å–å®Œæ•´ä¿¡æ¯
                    channel_request = self.youtube.channels().list(
                        part="snippet,statistics,brandingSettings",
                        id=channel_id
                    )
                    channel_response = channel_request.execute()

                    if channel_response.get('items'):
                        channel = channel_response['items'][0]
                        self.log_message(f"æˆåŠŸæ‰¾åˆ°é¢‘é“: {channel['snippet']['title']}")
                        return channel

            except Exception as e:
                self.log_message(f"æœç´¢é¢‘é“æ—¶å‡ºé”™: {str(e)}")

            return None

        except Exception as e:
            self.log_message(f"è·å–é¢‘é“ä¿¡æ¯æ—¶å‡ºé”™: {str(e)}")
            return None

    def get_channel_data(self, input_str):
        """è·å–é¢‘é“æ•°æ®çš„ä¸»æ–¹æ³•"""
        try:
            channel = self.extract_channel_info(input_str)
            if not channel:
                self.log_message(f"æ— æ³•è·å–é¢‘é“ä¿¡æ¯: {input_str}")
                return None

            channel_data = {
                'channel_name': channel['snippet']['title'],
                'description': channel['snippet']['description'],
                'subscriber_count': channel['statistics'].get('subscriberCount', 'N/A'),
                'view_count': channel['statistics'].get('viewCount', 'N/A'),
                'video_count': channel['statistics'].get('videoCount', 'N/A'),  # æ·»åŠ æ€»è§†é¢‘æ•°
                'created_date': channel['snippet']['publishedAt'],
                'country': channel['snippet'].get('country', 'Not specified'),
                'channel_id': channel['id']
            }

            self.log_message(f"æˆåŠŸè·å–é¢‘é“ä¿¡æ¯: {channel_data['channel_name']}")
            self.log_message(f"é¢‘é“æ€»è§†é¢‘æ•°: {channel_data['video_count']}")  # æ·»åŠ æ—¥å¿—è¾“å‡º
            return channel_data

        except Exception as e:
            self.log_message(f"è·å–é¢‘é“æ•°æ®æ—¶å‡ºé”™: {str(e)}")
            raise

    @retry(stop=stop_after_attempt(3), wait=wait_exponential(multiplier=1, min=4, max=10))
    def get_videos_details(self, video_ids):
        """è·å–è§†é¢‘è¯¦ç»†ä¿¡æ¯"""
        try:
            # æ¯æ¬¡æœ€å¤šè¯·æ±‚50ä¸ªè§†é¢‘çš„è¯¦æƒ…
            results = []
            for i in range(0, len(video_ids), 50):
                batch = video_ids[i:i + 50]
                request = self.youtube.videos().list(
                    part="snippet,statistics",  # statistics éƒ¨åˆ†åŒ…å«äº†ç‚¹èµæ•°å’Œè¯„è®ºæ•°
                    id=','.join(batch)
                )
                response = request.execute()
                results.extend(response['items'])
                self.log_message(f"æˆåŠŸè·å–ä¸€æ‰¹ {len(batch)} ä¸ªè§†é¢‘çš„è¯¦æƒ…")

            return results
        except Exception as e:
            self.log_message(f"è·å–è§†é¢‘è¯¦æƒ…æ—¶å‡ºé”™: {str(e)}")
            raise

    def get_channel_videos(self, channel_id):
        """è·å–é¢‘é“çš„æ‰€æœ‰ç¬¦åˆæ¡ä»¶çš„è§†é¢‘"""
        videos = []
        next_page_token = None
        total_videos_found = 0
        total_videos_filtered = 0
        page_count = 0

        try:
            while True:  # ç§»é™¤é¡µæ•°é™åˆ¶ï¼ŒæŒç»­è·å–ç›´åˆ°æ²¡æœ‰æ›´å¤šè§†é¢‘
                try:
                    self.log_message(f"æ­£åœ¨è·å–é¢‘é“ {channel_id} çš„è§†é¢‘åˆ—è¡¨... (ç¬¬ {page_count + 1} é¡µ)")
                    request = self.youtube.search().list(
                        part="id",
                        channelId=channel_id,
                        maxResults=50,  # YouTube API çš„æœ€å¤§é™åˆ¶
                        pageToken=next_page_token,
                        type="video",
                        order="date"  # æŒ‰æ—¥æœŸæ’åºï¼Œç¡®ä¿è·å–æ‰€æœ‰è§†é¢‘
                    )
                    response = request.execute()

                    if not response.get('items'):
                        self.log_message("æ²¡æœ‰æ‰¾åˆ°æ›´å¤šè§†é¢‘")
                        break

                    video_ids = [item['id']['videoId'] for item in response['items']]
                    total_videos_found += len(video_ids)
                    self.log_message(f"æœ¬é¡µæ‰¾åˆ° {len(video_ids)} ä¸ªè§†é¢‘")

                    # è·å–è§†é¢‘è¯¦æƒ…
                    try:
                        video_details = self.get_videos_details(video_ids)
                        self.log_message(f"æˆåŠŸè·å– {len(video_details)} ä¸ªè§†é¢‘çš„è¯¦ç»†ä¿¡æ¯")

                        # ç­›é€‰è§‚çœ‹æ•°å¤§äºé˜ˆå€¼çš„è§†é¢‘
                        filtered_videos = []
                        for video in video_details:
                            try:
                                view_count = int(video['statistics'].get('viewCount', 0))
                                self.log_message(f"è§†é¢‘ {video['id']} çš„è§‚çœ‹æ•°ä¸º: {view_count}")
                                if view_count &gt;= self.view_threshold:
                                    filtered_videos.append(video)
                                    self.log_message(
                                        f"è§†é¢‘ {video['id']} è§‚çœ‹æ•° {view_count} ç¬¦åˆæ¡ä»¶ï¼ˆå¤§äºç­‰äº {self.view_threshold}ï¼‰")
                                else:
                                    self.log_message(
                                        f"è§†é¢‘ {video['id']} è§‚çœ‹æ•° {view_count} ä¸ç¬¦åˆæ¡ä»¶ï¼ˆå°äº {self.view_threshold}ï¼‰")
                            except ValueError:
                                self.log_message(f"è§†é¢‘ {video['id']} çš„è§‚çœ‹æ•°æ— æ•ˆ")
                                continue

                        total_videos_filtered += len(filtered_videos)
                        self.log_message(f"æœ¬é¡µç­›é€‰å‡º {len(filtered_videos)} ä¸ªç¬¦åˆæ¡ä»¶çš„è§†é¢‘")
                        videos.extend(filtered_videos)

                    except Exception as e:
                        self.log_message(f"è·å–è§†é¢‘è¯¦æƒ…æ—¶å‡ºé”™: {str(e)}")
                        if "quotaExceeded" in str(e):
                            raise
                        continue

                    next_page_token = response.get('nextPageToken')
                    if not next_page_token:
                        self.log_message("æ²¡æœ‰æ›´å¤šé¡µé¢ï¼Œè§†é¢‘è·å–å®Œæˆ")
                        break

                    page_count += 1
                    self.log_message(f"å‡†å¤‡è·å–ä¸‹ä¸€é¡µæ•°æ® (å½“å‰ç¬¬ {page_count} é¡µ)")

                except Exception as e:
                    self.log_message(f"è·å–é¢‘é“è§†é¢‘åˆ—è¡¨æ—¶å‡ºé”™: {str(e)}")
                    if "quotaExceeded" in str(e):
                        raise
                    continue

            self.log_message(f"\né¢‘é“è§†é¢‘è·å–ç»Ÿè®¡:")
            self.log_message(f"- æ€»å…±æ‰¾åˆ°çš„è§†é¢‘æ•°: {total_videos_found}")
            self.log_message(f"- ç¬¦åˆè§‚çœ‹æ•°é˜ˆå€¼({self.view_threshold})çš„è§†é¢‘æ•°: {total_videos_filtered}")
            self.log_message(f"- æœ€ç»ˆæ”¶é›†åˆ°çš„è§†é¢‘æ•°: {len(videos)}")
            self.log_message(f"- å¤„ç†çš„é¡µæ•°: {page_count}")

            return videos

        except Exception as e:
            self.log_message(f"è·å–é¢‘é“è§†é¢‘æ—¶å‡ºé”™: {str(e)}")
            raise

    def save_videos_to_excel(self, channel_id, videos, original_url):
        """å°†è§†é¢‘æ•°æ®ä¿å­˜åˆ°Excel"""
        try:
            video_data = []
            processed_video_ids = set()

            # ä»URLä¸­æå–ç”¨æˆ·å
            username = None
            if '/@' in original_url:
                username = original_url.split('/@')[1].split('/')[0].strip()

            for video in videos:
                video_id = video['id']
                if video_id in processed_video_ids:
                    self.log_message(f"è·³è¿‡é‡å¤è§†é¢‘ID: {video_id}")
                    continue

                processed_video_ids.add(video_id)
                video_data.append({
                    'title': video['snippet']['title'],
                    'description': video['snippet']['description'],
                    'published_at': video['snippet']['publishedAt'],
                    'view_count': video['statistics'].get('viewCount', 'N/A'),
                    'like_count': video['statistics'].get('likeCount', 'N/A'),
                    'comment_count': video['statistics'].get('commentCount', 'N/A'),
                    'tags': ','.join(video['snippet'].get('tags', [])),
                    'url': f"https://www.youtube.com/watch?v={video_id}",
                    'video_id': video_id
                })

            if video_data:
                # è½¬æ¢ä¸ºDataFrame
                df = pd.DataFrame(video_data)

                # è®°å½•åŸå§‹æ•°æ®
                original_count = len(df)
                self.log_message(f"åŸå§‹æ•°æ®æ•°é‡: {original_count}")

                # åªåŸºäºvideo_idå»é‡
                df = df.drop_duplicates(subset=['video_id'], keep='first')

                # è®°å½•æ¸…æ´—åçš„æ•°æ®
                cleaned_count = len(df)
                self.log_message(f"æ¸…æ´—åæ•°æ®æ•°é‡: {cleaned_count}")

                if original_count &gt; cleaned_count:
                    self.log_message(f"æ¸…é™¤äº† {original_count - cleaned_count} æ¡é‡å¤æ•°æ®")
                    duplicate_ids = df['video_id'].value_counts()[df['video_id'].value_counts() &gt; 1].index
                    if len(duplicate_ids) &gt; 0:
                        self.log_message(f"é‡å¤çš„è§†é¢‘ID: {list(duplicate_ids)}")

                # åˆ é™¤video_idåˆ—
                df = df.drop('video_id', axis=1)

                # ä½¿ç”¨ç”¨æˆ·åä½œä¸ºæ–‡ä»¶åï¼Œå¦‚æœæ— æ³•è·å–ç”¨æˆ·ååˆ™ä½¿ç”¨é¢‘é“ID
                if username:
                    filename = f"{username}_videos.xlsx"
                else:
                    filename = f"{channel_id}_videos.xlsx"

                output_path = os.path.join(self.video_save_path, filename)
                df.to_excel(output_path, index=False)
                self.log_message(f"è§†é¢‘æ•°æ®å·²ä¿å­˜åˆ°: {output_path}")

            else:
                self.log_message("æ²¡æœ‰æ•°æ®éœ€è¦ä¿å­˜")

        except Exception as e:
            self.log_message(f"ä¿å­˜è§†é¢‘æ•°æ®æ—¶å‡ºé”™: {str(e)}")
            raise

    def process_excel_file(self, excel_path):
        """å¤„ç†Excelæ–‡ä»¶"""
        try:
            # è¯»å–Excelæ–‡ä»¶ï¼Œç¡®ä¿ä¸è·³è¿‡ä»»ä½•è¡Œ
            try:
                df = pd.read_excel(excel_path, dtype=str)
                df = df.dropna(how='all')
                df = df.reset_index(drop=True)

                self.log_message(f"æˆåŠŸè¯»å–Excelæ–‡ä»¶ï¼Œå…±æœ‰ {len(df)} ä¸ªé¢‘é“å¾…å¤„ç†")
                self.log_message(f"è¯»å–åˆ°çš„URLåˆ—è¡¨ï¼š{df.iloc[:, 0].tolist()}")
            except Exception as e:
                self.log_message(f"è¯»å–Excelæ–‡ä»¶å¤±è´¥: {str(e)}")
                return

            if df.empty:
                self.log_message("Excelæ–‡ä»¶ä¸ºç©º")
                return

            # ç¡®ä¿æ‰€éœ€çš„åˆ—å­˜åœ¨
            required_columns = ['channel_name', 'description', 'subscriber_count',
                                'view_count', 'video_count', 'created_date', 'country']  # æ·»åŠ  video_count
            for col in required_columns:
                if col not in df.columns:
                    df[col] = ''

            channel_urls = df.iloc[:, 0].astype(str).tolist()
            success_count = 0

            for idx, url in enumerate(channel_urls):
                if pd.isna(url) or url.strip() == '':
                    self.log_message(f"ç¬¬ {idx + 1} è¡Œçš„URLä¸ºç©ºï¼Œå·²è·³è¿‡")
                    continue

                try:
                    self.log_message(f"æ­£åœ¨å¤„ç†ç¬¬ {idx + 1}/{len(channel_urls)} ä¸ªé¢‘é“: {url}")

                    # ä½¿ç”¨æ–°çš„get_channel_dataæ–¹æ³•
                    channel_data = self.get_channel_data(url)
                    if channel_data:
                        for col, value in channel_data.items():
                            if col != 'channel_id':
                                df.loc[idx, col] = value

                        self.log_message(f"å¼€å§‹è·å–é¢‘é“ {url} çš„è§†é¢‘æ•°æ®...")
                        videos = self.get_channel_videos(channel_data['channel_id'])
                        if videos:
                            self.save_videos_to_excel(channel_data['channel_id'], videos, url)
                            self.log_message(f"æˆåŠŸä¿å­˜é¢‘é“ {url} çš„è§†é¢‘æ•°æ®ï¼Œå…± {len(videos)} ä¸ªè§†é¢‘")
                            # æ·»åŠ ç»Ÿè®¡ä¿¡æ¯
                            self.log_message(f"é¢‘é“ç»Ÿè®¡ä¿¡æ¯:")
                            self.log_message(f"- æ€»è§†é¢‘æ•°: {channel_data['video_count']}")
                            self.log_message(f"- ç¬¦åˆè§‚çœ‹é‡é˜ˆå€¼çš„è§†é¢‘æ•°: {len(videos)}")
                        else:
                            self.log_message(f"é¢‘é“ {url} æ²¡æœ‰ç¬¦åˆæ¡ä»¶çš„è§†é¢‘ï¼ˆè§‚çœ‹æ•° &gt;= {self.view_threshold}ï¼‰")

                        success_count += 1
                    else:
                        self.log_message(f"æ— æ³•è·å–é¢‘é“æ•°æ®: {url}")

                except Exception as e:
                    self.log_message(f"å¤„ç†é¢‘é“ {url} æ—¶å‡ºé”™: {str(e)}")
                    continue

            self.log_message(f"æ€»å…±å¤„ç†äº† {len(channel_urls)} ä¸ªé¢‘é“ï¼ŒæˆåŠŸ {success_count} ä¸ª")

            # ä¿å­˜æ›´æ–°åçš„Excelæ–‡ä»¶
            try:
                base_path = os.path.splitext(excel_path)[0]
                current_time = datetime.now().strftime("%Y%m%d_%H%M%S")
                new_excel_path = f"{base_path}_updated_{current_time}.xlsx"

                df.to_excel(new_excel_path, index=False)
                self.log_message(f"æ•°æ®å·²ä¿å­˜åˆ°æ–°æ–‡ä»¶: {new_excel_path}")

            except Exception as e:
                self.log_message(f"ä¿å­˜Excelæ–‡ä»¶æ—¶å‡ºé”™: {str(e)}")
                desktop_path = os.path.join(os.path.expanduser("~"), "Desktop")
                backup_file = os.path.join(desktop_path, f"youtube_data_backup_{current_time}.xlsx")
                try:
                    df.to_excel(backup_file, index=False)
                    self.log_message(f"æ•°æ®å·²ä¿å­˜åˆ°å¤‡ä»½æ–‡ä»¶: {backup_file}")
                except Exception as e2:
                    self.log_message(f"ä¿å­˜å¤‡ä»½æ–‡ä»¶ä¹Ÿå¤±è´¥: {str(e2)}")
                    raise

        except Exception as e:
            self.log_message(f"å¤„ç†Excelæ–‡ä»¶æ—¶å‡ºé”™: {str(e)}")
            raise

    def run(self, excel_path):
        """è¿è¡Œä¸»ç¨‹åº"""
        try:
            self.log_message("å¼€å§‹å¤„ç†æ•°æ®...")
            self.process_excel_file(excel_path)
            self.log_message("æ•°æ®å¤„ç†å®Œæˆï¼")
        except Exception as e:
            self.log_message(f"ç¨‹åºè¿è¡Œå‡ºé”™: {str(e)}")
            raise</pre>
<h4>UI</h4>
<pre>class YouTubeCollectorGUI:
    def __init__(self, root):
        self.root = root
        self.root.title("YouTubeæ•°æ®é‡‡é›†å™¨")
        self.root.geometry("700x650")

        # é…ç½®æ–‡ä»¶è·¯å¾„
        self.config_file = 'collector_config.json'
        # åŠ è½½é…ç½®
        self.load_config()

        # åˆ›å»ºæ¶ˆæ¯é˜Ÿåˆ—ç”¨äºæ›´æ–°è¿›åº¦
        self.message_queue = queue.Queue()

        # åˆ›å»ºä¸»æ¡†æ¶
        self.main_frame = ttk.Frame(root, padding="10")
        self.main_frame.grid(row=0, column=0, sticky=(tk.W, tk.E, tk.N, tk.S))

        # API Key è¾“å…¥ã€ä¿å­˜å’Œæ¸…ç©ºæŒ‰é’®
        ttk.Label(self.main_frame, text="YouTube API Key:").grid(row=0, column=0, sticky=tk.W, pady=5)
        self.api_key_var = tk.StringVar(value=self.saved_api_key)
        self.api_key_entry = ttk.Entry(self.main_frame, textvariable=self.api_key_var, width=50)
        self.api_key_entry.grid(row=0, column=1, sticky=(tk.W, tk.E), pady=5)

        # åˆ›å»ºä¸€ä¸ªæ¡†æ¶æ¥å®¹çº³API Keyçš„æŒ‰é’®
        api_key_buttons_frame = ttk.Frame(self.main_frame)
        api_key_buttons_frame.grid(row=0, column=2, sticky=tk.W, padx=5, pady=5)

        self.save_api_key_button = ttk.Button(api_key_buttons_frame, text="ä¿å­˜", command=self.save_api_key)
        self.save_api_key_button.pack(side=tk.LEFT, padx=(0, 5))

        self.clear_api_key_button = ttk.Button(api_key_buttons_frame, text="æ¸…ç©º", command=self.clear_api_key)
        self.clear_api_key_button.pack(side=tk.LEFT)

        # ä»£ç†è®¾ç½®ã€ä¿å­˜å’Œæ¸…ç©ºæŒ‰é’®
        ttk.Label(self.main_frame, text="ä»£ç†åœ°å€:").grid(row=1, column=0, sticky=tk.W, pady=5)
        self.proxy_var = tk.StringVar(value=self.saved_proxy)
        self.proxy_entry = ttk.Entry(self.main_frame, textvariable=self.proxy_var, width=50)
        self.proxy_entry.grid(row=1, column=1, sticky=(tk.W, tk.E), pady=5)

        # åˆ›å»ºä¸€ä¸ªæ¡†æ¶æ¥å®¹çº³ä»£ç†åœ°å€çš„æŒ‰é’®
        proxy_buttons_frame = ttk.Frame(self.main_frame)
        proxy_buttons_frame.grid(row=1, column=2, sticky=tk.W, padx=5, pady=5)

        self.save_proxy_button = ttk.Button(proxy_buttons_frame, text="ä¿å­˜", command=self.save_proxy)
        self.save_proxy_button.pack(side=tk.LEFT, padx=(0, 5))

        self.clear_proxy_button = ttk.Button(proxy_buttons_frame, text="æ¸…ç©º", command=self.clear_proxy)
        self.clear_proxy_button.pack(side=tk.LEFT)

        # è§‚çœ‹é‡é˜ˆå€¼è®¾ç½® (ä¿®æ”¹è¿™éƒ¨åˆ†)
        ttk.Label(self.main_frame, text="æ”¶é›†è§‚çœ‹é‡å¤§äº").grid(row=2, column=0, sticky=tk.W, pady=5)
        self.threshold_var = tk.StringVar()  # ä¸è®¾ç½®é»˜è®¤å€¼
        self.threshold_entry = ttk.Entry(self.main_frame, textvariable=self.threshold_var, width=15)
        self.threshold_entry.grid(row=2, column=1, sticky=tk.W, pady=5)
        ttk.Label(self.main_frame, text="çš„è§†é¢‘ä¿¡æ¯").grid(row=2, column=1, sticky=tk.W, padx=(120,0), pady=5)

        # Excelæ–‡ä»¶é€‰æ‹©
        ttk.Label(self.main_frame, text="é€‰æ‹©æä¾›é¢‘é“çš„Excelæ–‡ä»¶:").grid(row=3, column=0, sticky=tk.W, pady=5)
        self.excel_path_var = tk.StringVar()
        self.excel_path_entry = ttk.Entry(self.main_frame, textvariable=self.excel_path_var, width=40)
        self.excel_path_entry.grid(row=3, column=1, sticky=(tk.W, tk.E), pady=5)
        self.browse_button = ttk.Button(self.main_frame, text="æµè§ˆ", command=self.browse_excel_file)
        self.browse_button.grid(row=3, column=2, sticky=tk.W, padx=5, pady=5)

        # è§†é¢‘æ•°æ®ä¿å­˜è·¯å¾„é€‰æ‹©
        ttk.Label(self.main_frame, text="ä¿å­˜è·¯å¾„:").grid(row=4, column=0, sticky=tk.W, pady=5)
        self.save_path_var = tk.StringVar()
        self.save_path_entry = ttk.Entry(self.main_frame, textvariable=self.save_path_var, width=40)
        self.save_path_entry.grid(row=4, column=1, sticky=(tk.W, tk.E), pady=5)
        self.save_path_button = ttk.Button(self.main_frame, text="é€‰æ‹©", command=self.browse_save_path)
        self.save_path_button.grid(row=4, column=2, sticky=tk.W, padx=5, pady=5)

        # è¿›åº¦æ˜¾ç¤ºæ–‡æœ¬æ¡†
        self.progress_text = tk.Text(self.main_frame, height=15, width=60)
        self.progress_text.grid(row=5, column=0, columnspan=3, pady=10)

        # æ»šåŠ¨æ¡
        scrollbar = ttk.Scrollbar(self.main_frame, orient=tk.VERTICAL, command=self.progress_text.yview)
        scrollbar.grid(row=5, column=3, sticky=(tk.N, tk.S))
        self.progress_text['yscrollcommand'] = scrollbar.set

        # è¿›åº¦æ¡
        self.progress_var = tk.DoubleVar()
        self.progress_bar = ttk.Progressbar(self.main_frame, length=400, mode='determinate',
                                            variable=self.progress_var)
        self.progress_bar.grid(row=6, column=0, columnspan=3, pady=10)

        # å¼€å§‹æŒ‰é’®
        self.start_button = ttk.Button(self.main_frame, text="å¼€å§‹é‡‡é›†", command=self.start_collection)
        self.start_button.grid(row=7, column=0, columnspan=3, pady=10)

        # å®šæœŸæ£€æŸ¥æ¶ˆæ¯é˜Ÿåˆ—
        self.check_message_queue()

    def load_config(self):
        """åŠ è½½é…ç½®æ–‡ä»¶"""
        try:
            if os.path.exists(self.config_file):
                with open(self.config_file, 'r') as f:
                    config = json.load(f)
                    self.saved_api_key = config.get('api_key', '')
                    self.saved_proxy = config.get('proxy', '')  # é»˜è®¤ä¸ºç©ºå­—ç¬¦ä¸²
            else:
                self.saved_api_key = ''
                self.saved_proxy = ''  # é»˜è®¤ä¸ºç©ºå­—ç¬¦ä¸²
        except Exception as e:
            self.saved_api_key = ''
            self.saved_proxy = ''  # é»˜è®¤ä¸ºç©ºå­—ç¬¦ä¸²

    def clear_api_key(self):
        """æ¸…ç©ºAPI Key"""
        try:
            config = self.load_current_config()
            if 'api_key' in config:
                del config['api_key']
            self.save_config(config)
            self.api_key_var.set('')  # æ¸…ç©ºè¾“å…¥æ¡†
            self.saved_api_key = ''  # æ¸…ç©ºä¿å­˜çš„å€¼
            messagebox.showinfo("æˆåŠŸ", "API Keyå·²æ¸…ç©º")
        except Exception as e:
            messagebox.showerror("é”™è¯¯", f"æ¸…ç©ºAPI Keyå¤±è´¥: {str(e)}")

    def clear_proxy(self):
        """æ¸…ç©ºä»£ç†åœ°å€"""
        try:
            config = self.load_current_config()
            if 'proxy' in config:
                del config['proxy']
            self.save_config(config)
            self.proxy_var.set('')  # æ¸…ç©ºè¾“å…¥æ¡†
            self.saved_proxy = ''  # æ¸…ç©ºä¿å­˜çš„å€¼
            messagebox.showinfo("æˆåŠŸ", "ä»£ç†åœ°å€å·²æ¸…ç©º")
        except Exception as e:
            messagebox.showerror("é”™è¯¯", f"æ¸…ç©ºä»£ç†åœ°å€å¤±è´¥: {str(e)}")

    def save_api_key(self):
        """ä¿å­˜API Keyåˆ°é…ç½®æ–‡ä»¶"""
        api_key = self.api_key_var.get().strip()
        if not api_key:
            messagebox.showerror("é”™è¯¯", "API Keyä¸èƒ½ä¸ºç©º")
            return

        config = self.load_current_config()
        config['api_key'] = api_key
        self.save_config(config)
        self.saved_api_key = api_key  # æ›´æ–°ä¿å­˜çš„å€¼
        messagebox.showinfo("æˆåŠŸ", "API Keyå·²ä¿å­˜")

    def save_proxy(self):
        """ä¿å­˜ä»£ç†åœ°å€åˆ°é…ç½®æ–‡ä»¶"""
        proxy = self.proxy_var.get().strip()
        if not proxy:
            messagebox.showerror("é”™è¯¯", "ä»£ç†åœ°å€ä¸èƒ½ä¸ºç©º")
            return

        config = self.load_current_config()
        config['proxy'] = proxy
        self.save_config(config)
        self.saved_proxy = proxy  # æ›´æ–°ä¿å­˜çš„å€¼
        messagebox.showinfo("æˆåŠŸ", "ä»£ç†åœ°å€å·²ä¿å­˜")

    def load_current_config(self):
        """åŠ è½½å½“å‰é…ç½®"""
        if os.path.exists(self.config_file):
            try:
                with open(self.config_file, 'r') as f:
                    return json.load(f)
            except:
                pass
        return {}

    def save_config(self, config):
        """ä¿å­˜é…ç½®åˆ°æ–‡ä»¶"""
        try:
            with open(self.config_file, 'w') as f:
                json.dump(config, f)
        except Exception as e:
            messagebox.showerror("é”™è¯¯", f"ä¿å­˜é…ç½®æ–‡ä»¶å¤±è´¥: {str(e)}")

    def browse_excel_file(self):
        """é€‰æ‹©Excelæ–‡ä»¶"""
        filename = filedialog.askopenfilename(
            title="é€‰æ‹©Excelæ–‡ä»¶",
            filetypes=[("Excel files", "*.xlsx *.xls")]
        )
        if filename:
            self.excel_path_var.set(filename)

    def browse_save_path(self):
        """é€‰æ‹©ä¿å­˜è·¯å¾„"""
        dirname = filedialog.askdirectory(title="é€‰æ‹©ä¿å­˜è·¯å¾„")
        if dirname:
            self.save_path_var.set(dirname)

    def update_progress(self, message):
        """æ›´æ–°è¿›åº¦æ˜¾ç¤º"""
        self.progress_text.insert(tk.END, message + "\n")
        self.progress_text.see(tk.END)

    def check_message_queue(self):
        """æ£€æŸ¥æ¶ˆæ¯é˜Ÿåˆ—å¹¶æ›´æ–°UI"""
        try:
            while True:
                message = self.message_queue.get_nowait()
                self.update_progress(message)
        except queue.Empty:
            pass
        finally:
            self.root.after(100, self.check_message_queue)

    def custom_logger(self, message):
        """è‡ªå®šä¹‰æ—¥å¿—å¤„ç†å‡½æ•°"""
        self.message_queue.put(message)

    def validate_threshold(self):
        """éªŒè¯è§‚çœ‹é‡é˜ˆå€¼"""
        threshold = self.threshold_var.get().strip()
        if not threshold:
            messagebox.showerror("é”™è¯¯", "è¯·è¾“å…¥è§‚çœ‹é‡é˜ˆå€¼")
            return False
        if not threshold.isdigit():
            messagebox.showerror("é”™è¯¯", "è§‚çœ‹é‡é˜ˆå€¼å¿…é¡»ä¸ºæ•°å­—")
            return False
        return True

    def start_collection(self):
        """å¼€å§‹æ•°æ®é‡‡é›†"""
        # éªŒè¯è¾“å…¥
        if not self.api_key_var.get().strip():
            messagebox.showerror("é”™è¯¯", "è¯·è¾“å…¥YouTube API Key")
            return
        if not self.excel_path_var.get().strip():
            messagebox.showerror("é”™è¯¯", "è¯·é€‰æ‹©Excelæ–‡ä»¶")
            return
        if not os.path.exists(self.excel_path_var.get()):
            messagebox.showerror("é”™è¯¯", "Excelæ–‡ä»¶ä¸å­˜åœ¨")
            return
        if not self.save_path_var.get().strip():
            messagebox.showerror("é”™è¯¯", "è¯·é€‰æ‹©ä¿å­˜è·¯å¾„")
            return
        if not self.validate_threshold():
            return

        save_path = self.save_path_var.get().strip()
        if not os.path.exists(save_path):
            try:
                os.makedirs(save_path)
            except Exception as e:
                messagebox.showerror("é”™è¯¯", f"æ— æ³•åˆ›å»ºä¿å­˜è·¯å¾„: {str(e)}")
                return

        # ç¦ç”¨æŒ‰é’®å’Œè¾“å…¥æ¡†
        self.start_button.state(['disabled'])
        self.api_key_entry.state(['disabled'])
        self.proxy_entry.state(['disabled'])
        self.excel_path_entry.state(['disabled'])
        self.save_path_entry.state(['disabled'])
        self.browse_button.state(['disabled'])
        self.save_path_button.state(['disabled'])

        # æ¸…ç©ºè¿›åº¦æ˜¾ç¤º
        self.progress_text.delete(1.0, tk.END)
        self.progress_var.set(0)

        # åˆ›å»ºå¹¶å¯åŠ¨é‡‡é›†çº¿ç¨‹
        thread = threading.Thread(target=self.run_collection)
        thread.daemon = True
        thread.start()

    def run_collection(self):
        """è¿è¡Œé‡‡é›†ç¨‹åº"""
        try:
            # åˆ›å»ºé‡‡é›†å™¨å®ä¾‹ï¼Œç¡®ä¿æ­£ç¡®ä¼ å…¥è§‚çœ‹é‡é˜ˆå€¼
            collector = YouTubeDataCollector(
                api_key=self.api_key_var.get().strip(),
                view_threshold=int(self.threshold_var.get().strip()),  # ç¡®ä¿æ­£ç¡®ä¼ å…¥é˜ˆå€¼
                proxy=self.proxy_var.get().strip(),
                save_path=self.save_path_var.get().strip(),
                logger_callback=self.custom_logger
            )

            # è¿è¡Œé‡‡é›†
            collector.run(self.excel_path_var.get())

            # å®Œæˆåçš„å¤„ç†
            self.message_queue.put("é‡‡é›†å®Œæˆï¼")
            self.root.after(0, self.collection_completed)

        except Exception as e:
            error_message = str(e)
            if "é…é¢å·²ç”¨å®Œ" in error_message or "quotaExceeded" in error_message:
                detailed_message = (
                    "YouTube API é…é¢å·²ç”¨å®Œï¼\n\n"
                    "è§£å†³æ–¹æ³•ï¼š\n"
                    "1. ç­‰å¾…24å°æ—¶åå†è¯•\n"
                    "2. ä½¿ç”¨æ–°çš„ API Key\n"
                    "3. å¢åŠ é¡¹ç›®çš„é…é¢é™åˆ¶\n\n"
                    "å»ºè®®ï¼šæ¯ä¸ª API Key æ¯å¤©å¯ä»¥å¤„ç†çº¦ 100 ä¸ªé¢‘é“çš„æ•°æ®"
                )
                self.message_queue.put(f"é”™è¯¯: {detailed_message}")
                self.root.after(0, lambda: messagebox.showerror("API é…é¢è¶…é™", detailed_message))
            else:
                self.message_queue.put(f"é”™è¯¯: {error_message}")
            self.root.after(0, lambda: self.collection_error(error_message))

    def collection_error(self, error_message):
        """é‡‡é›†å‡ºé”™åçš„å¤„ç†"""
        if "é…é¢å·²ç”¨å®Œ" not in error_message and "quotaExceeded" not in error_message:
            messagebox.showerror("é”™è¯¯", error_message)
        self.enable_inputs()

    def collection_completed(self):
        """é‡‡é›†å®Œæˆåçš„å¤„ç†"""
        messagebox.showinfo("å®Œæˆ", "æ•°æ®é‡‡é›†å·²å®Œæˆï¼")
        self.enable_inputs()

    def collection_error(self, error_message):
        """é‡‡é›†å‡ºé”™åçš„å¤„ç†"""
        messagebox.showerror("é”™è¯¯", error_message)
        self.enable_inputs()

    def enable_inputs(self):
        """å¯ç”¨æ‰€æœ‰è¾“å…¥æ§ä»¶"""
        self.start_button.state(['!disabled'])
        self.api_key_entry.state(['!disabled'])
        self.proxy_entry.state(['!disabled'])
        self.excel_path_entry.state(['!disabled'])
        self.save_path_entry.state(['!disabled'])
        self.browse_button.state(['!disabled'])
        self.save_path_button.state(['!disabled'])


def main():
    root = tk.Tk()
    app = YouTubeCollectorGUI(root)
    root.mainloop()


if __name__ == "__main__":
    main()</pre>
<h2>Youtubeæ‰¹é‡è§†é¢‘ä¸‹è½½å™¨ï¼ˆå·²æ›´æ–°ï¼‰</h2>
<h3>åŠŸèƒ½è¯´æ˜</h3>
<p>Youtubeæ‰¹é‡è§†é¢‘ä¸‹è½½å™¨çš„ç•Œé¢å¦‚ä¸‹ï¼š</p>
<p><img src="img/2d1d02d6344551b2290199ec3a7ae1ab.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/SWD5b0ajgoZCgIx9bRzch5Cqn5f/"/></p>
<p>è¿™ä¸ªè½¯ä»¶çš„åŸç†ï¼š</p>
<p>è°ƒç”¨pythonçš„yt_dlpåº“ï¼Œä»è€Œå®ç°æœ¬åœ°æ‰¹é‡ä¸‹è½½youtubeè§†é¢‘ï¼ˆæ— æ•°é‡é™åˆ¶ï¼‰ï¼Œä½†æ˜¯è¦è®¾ç½®ä»£ç†ç«¯å£å’Œcookies</p>

<p>è¿™ä¸ªè½¯ä»¶å¯ä»¥å®ç°ä»¥ä¸‹åŠŸèƒ½ï¼š</p>
<p>(1) æ”¯æŒç”¨Excelæ–‡ä»¶æ‰¹é‡å¯¼å…¥è§†é¢‘é“¾æ¥ï¼Œå¹¶å®ç°æ‰¹é‡è‡ªåŠ¨ä¸‹è½½</p>
<p>(2) æ”¯æŒè‡ªé€‰åˆ†è¾¨ç‡ï¼ˆ720pã€1080pã€1440pï¼‰</p>
<p>(3) æ”¯æŒè°ƒæ•´ä¸‹è½½è§†é¢‘çš„æ•°é‡ï¼ˆå¦‚æœä½ çš„Excelæ–‡ä»¶é‡Œæœ‰5ä¸ªè§†é¢‘é“¾æ¥ï¼Œå¯ä»¥é€‰æ‹©ä¸‹è½½å‰nä¸ªï¼Œä»ä¸Šåˆ°ä¸‹ä¾æ¬¡ä¸‹è½½ï¼‰</p>

<h3>ä½¿ç”¨å‰å‡†å¤‡</h3>
<h4>ç¬¬ä¸€æ­¥ï¼Œæ‰“å¼€é­”æ³•</h4>
<p>ä¸Šé¢è®²è¿‡ï¼Œä¸å†èµ˜è¿°</p>

<h4>ç¬¬äºŒæ­¥ï¼Œè·å–ä½ çš„ä»£ç†ç«¯å£åœ°å€</h4>
<p>ã€ç‚¹å‡»è·³è½¬æ•™ç¨‹ã€‘</p>

<h4>ã€é‡ç‚¹ã€‘ç¬¬ä¸‰æ­¥ï¼Œè·å–ä½ çš„cookies</h4>
<p>â‘ ä¸‹è½½è·å–cookiesçš„æ’ä»¶ï¼š</p>
<p>https://chromewebstore.google.com/detail/cookie-editor/hlkenndednhfkekhgcdicdfddnkalmdm</p>

<p>â‘¡ä¸‹è½½å®Œä¹‹åï¼Œç‚¹å‡»å³ä¸Šè§’çš„æ‹¼å›¾å›¾æ ‡ï¼ŒæŠŠæ’ä»¶å›ºå®šåœ¨çŠ¶æ€æ ï¼ˆEdgeæ“ä½œä¹Ÿå·®ä¸å¤šï¼‰</p>
<p><img src="img/ae13e12899f457723b6af6446ffb49c9.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/ScPAbR22doQ2nYxFYd6c1vuQnhh/"/></p>

<p><img src="img/cc055679b33120516f582faebdbac3fc.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/QaP9bPEoQovFiNxTcDecgdvonZb/"/></p>

<p><img src="img/e32f1bd092602aecf6049cea0168740d.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/ByVebiHfNov49YxCHabc4Fo0njc/"/></p>

<p>â‘¢è¿›å…¥Youtubeé¦–é¡µï¼šhttps://www.youtube.com/ï¼Œç™»å½•è‡ªå·±çš„è´¦å·ï¼Œç„¶åç‚¹å‡»å³ä¸Šè§’çš„æ’ä»¶é€‰æ‹©â€œThis Siteâ€</p>
<p><img src="img/391a267c580e510fefeac2031174e9e5.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/JEZ3b5nDvoLLLrxYAsMcGavWnih/"/></p>

<p><img src="img/55f592c2337596963fcdf6ecc84371cc.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/ZoRDbHB03oFmM4xFZLicQkFlniW/"/></p>

<p>â‘£ç‚¹å‡»æ’ä»¶å³ä¸‹è§’å›¾æ ‡â€œExportâ€ï¼Œé€‰æ‹©â€œNetscapeâ€ï¼Œå°±æŠŠcookieså¤åˆ¶åˆ°ç²˜è´´æ¿äº†</p>
<p><img src="img/ad2f1b1a93f783191f4d8f7579cb9dea.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/Qoo4bHX0CoqdQxxPpK6ckdQhnCe/"/></p>

<p><img src="img/2057da4af167e5afa2a365ec9ed6ac32.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/CSnxbLF77oxErZxM0rec0s6HnQN/"/></p>


<p>â‘¤åœ¨éšä¾¿ä¸€ä¸ªä½ç½®ï¼Œé¼ æ ‡å³é”®æ–°å»ºä¸€ä¸ª.txtæ–‡ä»¶ï¼ˆå‘½åéšæ„ï¼‰ï¼ŒæŠŠåˆšåˆšå¤åˆ¶çš„cookiesç²˜è´´è¿›å»ï¼ŒCtrl+Sä¿å­˜</p>
<p><img src="img/1e157274acbfd6b5a451c648a3ca9bc5.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/HCp8bwCNro3L8xxfZQqcjXManuf/"/></p>

<p><img src="img/e13f61bba052623fb6b7350d87dff673.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/Elg4bBxKFoqz3yxRsdYcBwY6nAd/"/></p>


<p>â‘¥æ‰“å¼€è½¯ä»¶ï¼Œåœ¨â€œCookiesæ–‡ä»¶â€è¿™ä¸€æ é€‰ä¸­åˆšåˆšæ”¾æœ‰cookiesçš„txtæ–‡ä»¶å³å¯</p>
<p><img src="img/153cec07f22c7a59709c7c61599e2bf9.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/C0ztbxcT4ofoMhxOjtlclpDWnWh/"/></p>

<p>æ³¨æ„ï¼š</p>
<p>cookiesæ¯éš”ä¸¤å‘¨è¦æ›´æ¢ä¸€æ¬¡ï¼ŒåŒæ ·æ˜¯æŒ‰ç…§ä¸Šè¿°æ“ä½œæµç¨‹ï¼Œcookieså‡†å¤‡è¿‡æœŸçš„æ—¶å€™ï¼Œç¨‹åºä¼šè‡ªåŠ¨æé†’</p>

<h4>ã€é‡ç‚¹ã€‘ç¬¬å››æ­¥ï¼Œå‡†å¤‡ä¸€ä¸ªæä¾›è§†é¢‘é“¾æ¥çš„æ–‡ä»¶</h4>
<p>è§†é¢‘é“¾æ¥å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼è·å–ï¼š</p>
<p>â‘ ç”¨Youtubeæ•°æ®é‡‡é›†å™¨æ”¶é›†çš„é“¾æ¥ï¼Œå¯ä»¥æ— ç¼è¡”æ¥æ‰¹é‡ä¸‹è½½</p>
<p>â‘¡æ™®é€šè§†é¢‘è·å–æ–¹å¼</p>
<p><img src="img/fe059b6d9eff38d81ec8155442d6fac9.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/L8XXbR492oBn19xwgAfckdMbnsf/"/></p>

<p><img src="img/837172c07c262777c44b38b3d7e1a383.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/Z0pHbC9VYoIiXlxqSBFccMqDnWb/"/></p>
<p><img src="img/f8742a117e01fcd2075eb98bda27427e.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/ZN4SbcxiOo0QIkxWq5fcEgAQnAd/"/></p>

<p>â‘¢shortsè·å–æ–¹å¼</p>
<p><img src="img/3bdf86cb3bf530410615556498928fa1.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/Nc28bTZKdoCBa0xtjmfcwpsNnpd/"/></p>


<p><img src="img/32428742929d3f427403a4847ed5c05c.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/UCE4bq9jqoOBJJxloPbcxyLsnQd/"/></p>
<p><img src="img/47ea4754542c680248c9e2578b653cdb.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/SmnTbCsEAoXNZaxUwVocg4xgngf/"/></p>

<p>Excelæ–‡ä»¶çš„æ ¼å¼å¦‚ä¸‹å›¾ï¼Œè§†é¢‘é“¾æ¥æ”¾åœ¨ç¬¬å‡ åˆ—éƒ½å¯ä»¥ï¼Œä½†æ˜¯æ”¾è§†é¢‘é“¾æ¥çš„é‚£ä¸€åˆ—ï¼Œæœ€ä¸Šé¢ä¸€æ ¼ä¸€å®šè¦è¾“å…¥â€œURL"æˆ–è€…â€urlâ€œï¼Œä¸ç„¶ç¨‹åºè¯†åˆ«ä¸åˆ°ï¼ï¼ï¼</p>
<p><img src="img/0e54148261dedc6043a7d9fd5d8fa3dd.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/KX6abaf8Rofb4NxombTc2BUlnCd/"/></p>

<p><img src="img/3839bd4b6e08c421c090f1b87300077a.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/TziEb5QjDoWHLNxleygcJSTPnkc/"/></p>

<h3>ä½¿ç”¨æŒ‡å¼•</h3>
<p>å®Œæˆä»¥ä¸Šå‡†å¤‡ä¹‹åï¼Œæ‰“å¼€è½¯ä»¶</p>

<p>â‘  è¾“å…¥ä»£ç†åœ°å€ï¼ˆå¹¶ä¿å­˜ï¼‰</p>
<p><img src="img/e90fc09c422bd0f1455d7403293d56a7.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/J3ykb1CTWodoYmxpJsUcAmemnoc/"/></p>

<p>â‘¡ é€‰æ‹©å­˜æ”¾è§†é¢‘é“¾æ¥çš„Excelæ–‡ä»¶</p>
<p><img src="img/7b917cdc8622c5e35da8408d663ee953.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/RaR1bUvW0oawo4xxGZUcC7T0nrd/"/></p>

<p>â‘¢ é€‰æ‹©ä¸‹è½½åçš„è§†é¢‘çš„ä¿å­˜ä½ç½®</p>
<p><img src="img/5240b1e41cc07591f18dd8415f534fcc.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/EPjObUN9GowOhXxWE4UctMGonec/"/></p>

<p>â‘£é€‰æ‹©ä¿å­˜cookiesçš„txtæ–‡ä»¶</p>
<p><img src="img/4858939d8bbe112e7d6fad8d22e053ce.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/Os9DbTKgMoS83bxEi1UcU6NpnRb/"/></p>

<p>â‘¤ é€‰æ‹©è¦ä¸‹è½½çš„è§†é¢‘åˆ†è¾¨ç‡</p>

<p>â‘¥ é€‰æ‹©è¦ä¸‹è½½çš„è§†é¢‘æ•°é‡</p>
<p>(å³ä¾§ä¼šæ˜¾ç¤ºåœ¨Excelæ–‡ä»¶ä¸­è¯†åˆ«å‡ºäº†å¤šå°‘ä¸ªå¯ä»¥ä¸‹è½½çš„è§†é¢‘ï¼Œè¾“å…¥nï¼Œå°±ä¼šä¸‹è½½å‰nä¸ªï¼Œç¨‹åºä¼šä»ä¸Šåˆ°ä¸‹ä¾æ¬¡è¯»å–é“¾æ¥å¹¶ä¸‹è½½ï¼Œå³å°†ä¸‹è½½çš„è§†é¢‘é“¾æ¥ä¼šæ˜¾ç¤ºåœ¨ä¸‹æ–¹æ–‡æœ¬æ¡†ï¼‰</p>
<p><img src="img/352b14c1f2830e8046991f606594dab5.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/HwbkbF197oviZuxQuCkcDC8Hn9b/"/></p>

<p><img src="img/9fde81f2386431cfcdb4ff4c167b9c9f.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/HOWzbv8OroS4dPx96NDcWDtBnBc/"/></p>


<p>â‘¦ å¼€å§‹ä¸‹è½½</p>

<p>ä¸‹è½½å®Œæ¯•ä¹‹åï¼Œè¿˜ä¼šä¿å­˜ä¸€ä¸ªExcelåˆ—è¡¨ï¼ˆåå­—ä¸ºâ€œä¸‹è½½ç»“æœ_å…·ä½“ä¸‹è½½æ—¶é—´â€ï¼‰ï¼Œé‡Œé¢æ ‡æ˜å„ä¸ªè§†é¢‘æ˜¯å¦æˆåŠŸä¸‹è½½</p>
<p><img src="img/9e4ad7f4d9a33ad5d77da4aecd1d3c10.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/LZzubgWBUovKiMxsbErciREAnGh/"/></p>

<h3>è½¯ä»¶åœ°å€</h3>
<p>é€šè¿‡ç™¾åº¦ç½‘ç›˜åˆ†äº«çš„æ–‡ä»¶ï¼šYoutubeæ‰¹é‡è§†é¢‘ä¸‹è½½.rar</p>
<p>é“¾æ¥ï¼šhttps://pan.baidu.com/s/1_zFUb72xeABeVpldlqambQ?pwd=xrmc</p>
<p>æå–ç ï¼šxrmc</p>

<h3>æºä»£ç </h3>
<h4>ä¸»ç¨‹åº</h4>
<pre>import yt_dlp
from tqdm import tqdm
import os
import pandas as pd
from concurrent.futures import ThreadPoolExecutor
import time


def get_format_option(resolution):
    """æ ¹æ®é€‰æ‹©çš„åˆ†è¾¨ç‡è¿”å›æ ¼å¼é€‰é¡¹"""
    resolution_map = {
        '720p': 720,
        '1080p': 1080,
        '1440p': 1440
    }
    height = resolution_map[resolution]
    # æ·»åŠ ç¼–ç æ ¼å¼é™åˆ¶ï¼Œä¼˜å…ˆé€‰æ‹© H.264 ç¼–ç 
    return f'bestvideo[height&lt;={height}][vcodec^=avc]+bestaudio[ext=m4a]/best[height&lt;={height}]/best'


def batch_download(urls, output_path, resolution, proxy=None, progress_callback=None):
    """æ‰¹é‡ä¸‹è½½è§†é¢‘çš„å‡½æ•°"""
    results = []
    total = len(urls)
    completed = 0

    ydl_opts = {
        'format': get_format_option(resolution),
        'outtmpl': os.path.join(output_path, '%(title)s.%(ext)s'),
        'merge_output_format': 'mp4',
        'ignoreerrors': True,
        'quiet': True,
        'no_warnings': True,
        'format_sort': ['vcodec:h264'],
        # ä½¿ç”¨aria2cä½œä¸ºå¤–éƒ¨ä¸‹è½½å™¨
        'external_downloader': 'aria2c',
        'external_downloader_args': [
            '--min-split-size=1M',  # æœ€å°åˆ†ç‰‡å¤§å°
            '--max-connection-per-server=16',  # å•ä¸ªæœåŠ¡å™¨æœ€å¤§è¿æ¥æ•°
            '--split=16',  # å•ä¸ªæ–‡ä»¶åˆ†æˆ16ç‰‡ä¸‹è½½
            '--max-concurrent-downloads=3',  # åŒæ—¶ä¸‹è½½æ•°
            '--continue=true',  # æ”¯æŒæ–­ç‚¹ç»­ä¼ 
            '--optimize-concurrent-downloads=true'  # ä¼˜åŒ–å¹¶å‘ä¸‹è½½
        ]
    }

    if proxy:
        ydl_opts['proxy'] = proxy
        # ä¸ºaria2cä¹Ÿæ·»åŠ ä»£ç†è®¾ç½®
        ydl_opts['external_downloader_args'].extend([
            f'--all-proxy={proxy}'
        ])

    # æ·»åŠ ä¸‹è½½è¿›åº¦å›è°ƒ
    def download_progress_hook(d):
        if d['status'] == 'downloading':
            try:
                downloaded = d.get('downloaded_bytes', 0)
                total_bytes = d.get('total_bytes') or d.get('total_bytes_estimate', 0)
                if total_bytes:
                    video_progress = downloaded / total_bytes
                    total_progress = (completed + video_progress) / total
                    if progress_callback:
                        progress_callback(total_progress, f"æ­£åœ¨ä¸‹è½½ç¬¬ {completed + 1}/{total} ä¸ªè§†é¢‘")
            except Exception:
                pass

    ydl_opts['progress_hooks'] = [download_progress_hook]

    for i, url in enumerate(urls):
        try:
            with yt_dlp.YoutubeDL(ydl_opts) as ydl:
                ydl.download([url])
                results.append({
                    'URL': url,
                    'çŠ¶æ€': 'æˆåŠŸ',
                    'ä¿¡æ¯': 'ä¸‹è½½æˆåŠŸ'
                })
        except Exception as e:
            results.append({
                'URL': url,
                'çŠ¶æ€': 'å¤±è´¥',
                'ä¿¡æ¯': str(e)
            })

        completed += 1
        if progress_callback:
            progress_callback(completed / total, f"å®Œæˆç¬¬ {completed}/{total} ä¸ªè§†é¢‘")

    return results


def read_urls_from_excel(file_path):
    """ä»Excelæ–‡ä»¶è¯»å–URLåˆ—è¡¨"""
    try:
        df = pd.read_excel(file_path)
        url_column = None
        for col in df.columns:
            if col.lower() == 'url':
                url_column = col
                print(f"æ‰¾åˆ°URLåˆ—ï¼š{col}ï¼ˆç¬¬ {list(df.columns).index(col) + 1} åˆ—ï¼‰")
                break

        if url_column is None:
            print("é”™è¯¯ï¼šExcelæ–‡ä»¶ä¸­æ²¡æœ‰æ‰¾åˆ°'URL'æˆ–'url'åˆ—")
            return None

        urls = df[url_column].dropna().tolist()
        return urls
    except Exception as e:
        print(f"è¯»å–Excelæ–‡ä»¶æ—¶å‡ºé”™: {str(e)}")
        return None


def save_results_to_excel(results, output_path):
    """ä¿å­˜ä¸‹è½½ç»“æœåˆ°Excelæ–‡ä»¶"""
    try:
        df = pd.DataFrame(results)
        result_file = os.path.join(output_path, f'ä¸‹è½½ç»“æœ_{time.strftime("%Y%m%d_%H%M%S")}.xlsx')
        df.to_excel(result_file, index=False)
        print(f"\nä¸‹è½½ç»“æœå·²ä¿å­˜åˆ°: {result_file}")
    except Exception as e:
        print(f"ä¿å­˜ç»“æœæ–‡ä»¶æ—¶å‡ºé”™: {str(e)}")


def get_valid_path():
    """è·å–æœ‰æ•ˆçš„ä¿å­˜è·¯å¾„"""
    while True:
        path = input("è¯·è¾“å…¥ä¿å­˜è§†é¢‘çš„å®Œæ•´è·¯å¾„: ").strip()
        if not path:
            print("é”™è¯¯ï¼šè¯·è¾“å…¥æœ‰æ•ˆçš„ä¿å­˜è·¯å¾„ï¼")
            continue

        path = os.path.abspath(path)

        try:
            if not os.path.exists(path):
                os.makedirs(path)
            if os.access(path, os.W_OK):
                return path
            else:
                print("é”™è¯¯ï¼šæ²¡æœ‰å†™å…¥æƒé™ï¼Œè¯·é€‰æ‹©å…¶ä»–è·¯å¾„")
        except Exception as e:
            print(f"é”™è¯¯ï¼šæ— æ•ˆçš„è·¯å¾„ ({str(e)})")


def get_resolution_choice():
    """è·å–ç”¨æˆ·é€‰æ‹©çš„åˆ†è¾¨ç‡"""
    while True:
        print("\nè¯·é€‰æ‹©ä¸‹è½½è§†é¢‘çš„åˆ†è¾¨ç‡ï¼š")
        print("1. 720p")
        print("2. 1080p")
        print("3. 1440p")
        choice = input("è¯·è¾“å…¥é€‰æ‹©ï¼ˆ1-3ï¼‰: ").strip()

        resolution_map = {
            '1': '720p',
            '2': '1080p',
            '3': '1440p'
        }

        if choice in resolution_map:
            return resolution_map[choice]
        print("æ— æ•ˆçš„é€‰æ‹©ï¼Œè¯·é‡æ–°è¾“å…¥ï¼")


def main():
    print("YouTubeè§†é¢‘æ‰¹é‡ä¸‹è½½å™¨")
    print("=" * 50)

    # è·å–Excelæ–‡ä»¶è·¯å¾„
    while True:
        excel_path = input("è¯·è¾“å…¥Excelæ–‡ä»¶çš„å®Œæ•´è·¯å¾„: ").strip()
        if os.path.exists(excel_path):
            break
        print("é”™è¯¯ï¼šæ–‡ä»¶ä¸å­˜åœ¨ï¼Œè¯·é‡æ–°è¾“å…¥ï¼")

    # è¯»å–URLåˆ—è¡¨
    urls = read_urls_from_excel(excel_path)
    if not urls:
        print("æ— æ³•ä»Excelæ–‡ä»¶ä¸­è¯»å–URLï¼Œè¯·æ£€æŸ¥æ–‡ä»¶æ ¼å¼")
        return

    print(f"ä»Excelä¸­è¯»å–åˆ° {len(urls)} ä¸ªURL")

    # è·å–ä¿å­˜è·¯å¾„
    save_path = get_valid_path()
    print(f"è§†é¢‘å°†ä¿å­˜åˆ°: {save_path}")

    # è·å–åˆ†è¾¨ç‡é€‰æ‹©
    resolution = get_resolution_choice()
    print(f"å·²é€‰æ‹©ä¸‹è½½åˆ†è¾¨ç‡: {resolution}")

    # è·å–ä¸‹è½½æ•°é‡
    while True:
        try:
            max_videos = input(f"è¯·è¾“å…¥è¦ä¸‹è½½çš„è§†é¢‘æ•°é‡ï¼ˆæœ€å¤§{len(urls)}ä¸ªï¼Œç›´æ¥å›è½¦ä¸‹è½½å…¨éƒ¨ï¼‰: ").strip()
            if not max_videos:
                max_videos = None
                break
            max_videos = int(max_videos)
            if 1 &lt;= max_videos &lt;= len(urls):
                break
            print(f"è¯·è¾“å…¥1åˆ°{len(urls)}ä¹‹é—´çš„æ•°å­—ï¼")
        except ValueError:
            print("è¯·è¾“å…¥æœ‰æ•ˆçš„æ•°å­—ï¼")

    # æ‰§è¡Œæ‰¹é‡ä¸‹è½½
    results = batch_download(urls, save_path, resolution, max_videos)

    # ä¿å­˜ä¸‹è½½ç»“æœ
    save_results_to_excel(results, save_path)

    # æ˜¾ç¤ºç»Ÿè®¡ä¿¡æ¯
    success_count = sum(1 for r in results if r['çŠ¶æ€'] == 'æˆåŠŸ')
    print(f"\nä¸‹è½½å®Œæˆï¼æˆåŠŸ: {success_count}/{len(results)}")


if __name__ == "__main__":
    main()</pre>
<h4>UI</h4>
<pre>import tkinter as tk
from tkinter import ttk, filedialog, messagebox
import json
import os
from Youtube_Downloader import batch_download, read_urls_from_excel
from threading import Thread


class YoutubeDownloaderUI:
    def __init__(self, root):
        self.root = root
        self.root.title("YouTubeè§†é¢‘æ‰¹é‡ä¸‹è½½å™¨")
        self.root.geometry("900x800")  # å¢åŠ çª—å£é«˜åº¦ä»¥é€‚åº”æ–°æ·»åŠ çš„é“¾æ¥æ˜¾ç¤ºåŒºåŸŸ

        # è®¾ç½®æ•´ä½“æ ·å¼
        self.style = ttk.Style()
        self.style.configure('TFrame', background='#f0f0f0')
        self.style.configure('Header.TLabel', font=('Microsoft YaHei UI', 12, 'bold'), background='#f0f0f0')
        self.style.configure('TLabel', font=('Microsoft YaHei UI', 10), background='#f0f0f0')
        self.style.configure('TButton', font=('Microsoft YaHei UI', 10))
        self.style.configure('Download.TButton', font=('Microsoft YaHei UI', 11, 'bold'))

        # åŠ è½½ä¿å­˜çš„ä»£ç†è®¾ç½®
        self.proxy_config_file = 'proxy_config.json'
        self.saved_proxy = self.load_proxy_config()

        self.urls = []
        self.setup_ui()
        self.setup_callbacks()

    def setup_ui(self):
        # åˆ›å»ºä¸»å®¹å™¨
        main_container = ttk.Frame(self.root, padding="20", style='TFrame')
        main_container.grid(row=0, column=0, sticky=(tk.W, tk.E, tk.N, tk.S))
        self.root.columnconfigure(0, weight=1)
        self.root.rowconfigure(0, weight=1)

        # æ ‡é¢˜
        title_label = ttk.Label(main_container, text="YouTubeè§†é¢‘æ‰¹é‡ä¸‹è½½å™¨",
                                style='Header.TLabel')
        title_label.grid(row=0, column=0, columnspan=3, pady=(0, 20))

        # åˆ›å»ºè¾“å…¥åŒºåŸŸæ¡†æ¶
        input_frame = ttk.LabelFrame(main_container, text="ä¸‹è½½è®¾ç½®", padding="10")
        input_frame.grid(row=1, column=0, columnspan=3, sticky=(tk.W, tk.E), pady=(0, 20))

        # Excelæ–‡ä»¶é€‰æ‹©
        ttk.Label(input_frame, text="Excelæ–‡ä»¶è·¯å¾„:").grid(row=0, column=0, sticky=tk.W, pady=8)
        self.excel_path = tk.StringVar()
        excel_entry = ttk.Entry(input_frame, textvariable=self.excel_path, width=60)
        excel_entry.grid(row=0, column=1, sticky=tk.W, padx=(10, 10))
        ttk.Button(input_frame, text="æµè§ˆ", command=self.select_excel, width=15).grid(row=0, column=2)

        # ä¿å­˜è·¯å¾„é€‰æ‹©
        ttk.Label(input_frame, text="ä¿å­˜è·¯å¾„:").grid(row=1, column=0, sticky=tk.W, pady=8)
        self.save_path = tk.StringVar()
        save_entry = ttk.Entry(input_frame, textvariable=self.save_path, width=60)
        save_entry.grid(row=1, column=1, sticky=tk.W, padx=(10, 10))
        ttk.Button(input_frame, text="æµè§ˆ", command=self.select_save_path, width=15).grid(row=1, column=2)

        # ä»£ç†è®¾ç½®
        ttk.Label(input_frame, text="ä»£ç†åœ°å€:").grid(row=2, column=0, sticky=tk.W, pady=8)
        self.proxy = tk.StringVar(value=self.saved_proxy)
        proxy_entry = ttk.Entry(input_frame, textvariable=self.proxy, width=60)
        proxy_entry.grid(row=2, column=1, sticky=tk.W, padx=(10, 10))
        ttk.Button(input_frame, text="ä¿å­˜ä»£ç†", command=self.save_proxy, width=15).grid(row=2, column=2)

        # åˆ›å»ºé€‰é¡¹åŒºåŸŸæ¡†æ¶
        options_frame = ttk.LabelFrame(main_container, text="ä¸‹è½½é€‰é¡¹", padding="10")
        options_frame.grid(row=2, column=0, columnspan=3, sticky=(tk.W, tk.E), pady=(0, 20))

        # åˆ†è¾¨ç‡é€‰æ‹©
        ttk.Label(options_frame, text="è§†é¢‘åˆ†è¾¨ç‡:").grid(row=0, column=0, sticky=tk.W, pady=8)
        self.resolution = tk.StringVar(value="1080p")
        resolution_frame = ttk.Frame(options_frame)
        resolution_frame.grid(row=0, column=1, sticky=tk.W, padx=(10, 0))

        resolutions = [("720p", "720p"), ("1080p", "1080p"), ("1440p", "1440p")]
        for i, (text, value) in enumerate(resolutions):
            ttk.Radiobutton(resolution_frame, text=text, variable=self.resolution,
                            value=value).grid(row=0, column=i, padx=20)

        # ä¸‹è½½æ•°é‡è®¾ç½®
        ttk.Label(options_frame, text="ä¸‹è½½æ•°é‡:").grid(row=1, column=0, sticky=tk.W, pady=8)
        download_frame = ttk.Frame(options_frame)
        download_frame.grid(row=1, column=1, sticky=tk.W, padx=(10, 0))

        self.download_count = tk.StringVar()
        ttk.Entry(download_frame, textvariable=self.download_count, width=10).grid(row=0, column=0)
        self.max_videos_label = ttk.Label(download_frame, text="æœ€å¤šå¯ä»¥ä¸‹è½½0ä¸ªè§†é¢‘")
        self.max_videos_label.grid(row=0, column=1, padx=(20, 0))

        # åˆ›å»ºè§†é¢‘é“¾æ¥æ˜¾ç¤ºåŒºåŸŸ
        urls_frame = ttk.LabelFrame(main_container, text="è§†é¢‘é“¾æ¥åˆ—è¡¨", padding="10")
        urls_frame.grid(row=3, column=0, columnspan=3, sticky=(tk.W, tk.E), pady=(0, 20))

        # åˆ›å»ºæ»šåŠ¨æ–‡æœ¬æ¡†
        self.urls_text = tk.Text(urls_frame, height=6, width=80, font=('Microsoft YaHei UI', 9))
        scrollbar = ttk.Scrollbar(urls_frame, orient="vertical", command=self.urls_text.yview)
        self.urls_text.configure(yscrollcommand=scrollbar.set)

        self.urls_text.grid(row=0, column=0, sticky=(tk.W, tk.E, tk.N, tk.S), padx=(0, 5))
        scrollbar.grid(row=0, column=1, sticky=(tk.N, tk.S))

        # è®¾ç½®æ–‡æœ¬æ¡†åªè¯»
        self.urls_text.configure(state='disabled')

        # åˆ›å»ºè¿›åº¦æ˜¾ç¤ºåŒºåŸŸ
        progress_frame = ttk.LabelFrame(main_container, text="ä¸‹è½½è¿›åº¦", padding="10")
        progress_frame.grid(row=4, column=0, columnspan=3, sticky=(tk.W, tk.E), pady=(0, 20))

        self.progress_label = ttk.Label(progress_frame, text="å‡†å¤‡å°±ç»ª")
        self.progress_label.grid(row=0, column=0, columnspan=3, sticky=tk.W, pady=(0, 5))

        self.progress = ttk.Progressbar(progress_frame, length=800, mode='determinate')
        self.progress.grid(row=1, column=0, columnspan=3, sticky=(tk.W, tk.E), pady=(0, 5))

        self.status_label = ttk.Label(progress_frame, text="æ€»è¿›åº¦: 0%")
        self.status_label.grid(row=2, column=0, columnspan=3, sticky=tk.W)

        # ä¸‹è½½æŒ‰é’®
        self.download_button = ttk.Button(main_container, text="å¼€å§‹ä¸‹è½½",
                                          command=self.start_download, style='Download.TButton', width=20)
        self.download_button.grid(row=5, column=0, columnspan=3, pady=10)

    def setup_callbacks(self):
        """è®¾ç½®å›è°ƒå‡½æ•°"""

        def on_download_count_change(*args):
            if self.urls:
                self.update_urls_display()

        self.download_count.trace_add("write", on_download_count_change)

    def update_urls_display(self):
        """æ›´æ–°è§†é¢‘é“¾æ¥æ˜¾ç¤º"""
        self.urls_text.configure(state='normal')
        self.urls_text.delete(1.0, tk.END)

        count = int(self.download_count.get()) if self.download_count.get() else len(self.urls)
        count = min(count, len(self.urls))

        for i, url in enumerate(self.urls[:count], 1):
            self.urls_text.insert(tk.END, f"{i}. {url}\n")

        self.urls_text.configure(state='disabled')

    def load_proxy_config(self):
        try:
            if os.path.exists(self.proxy_config_file):
                with open(self.proxy_config_file, 'r') as f:
                    config = json.load(f)
                    return config.get('proxy', '')
        except Exception:
            pass
        return ''

    def save_proxy(self):
        proxy = self.proxy.get()
        try:
            with open(self.proxy_config_file, 'w') as f:
                json.dump({'proxy': proxy}, f)
            messagebox.showinfo("æˆåŠŸ", "ä»£ç†è®¾ç½®å·²ä¿å­˜")
        except Exception as e:
            messagebox.showerror("é”™è¯¯", f"ä¿å­˜ä»£ç†è®¾ç½®å¤±è´¥: {str(e)}")

    def select_excel(self):
        filename = filedialog.askopenfilename(
            filetypes=[("Excel files", "*.xlsx *.xls")]
        )
        if filename:
            self.excel_path.set(filename)
            self.urls = read_urls_from_excel(filename) or []
            self.max_videos_label.config(text=f"æœ€å¤šå¯ä»¥ä¸‹è½½{len(self.urls)}ä¸ªè§†é¢‘")
            self.update_urls_display()

    def select_save_path(self):
        path = filedialog.askdirectory()
        if path:
            self.save_path.set(path)

    def update_progress(self, progress, status_text):
        """æ›´æ–°è¿›åº¦æ˜¾ç¤º"""
        self.progress['value'] = progress * 100
        self.progress_label.config(text=status_text)
        self.status_label.config(text=f"æ€»è¿›åº¦: {progress:.1%}")
        self.root.update_idletasks()

    def validate_inputs(self):
        if not self.excel_path.get():
            messagebox.showerror("é”™è¯¯", "è¯·é€‰æ‹©Excelæ–‡ä»¶")
            return False
        if not self.save_path.get():
            messagebox.showerror("é”™è¯¯", "è¯·é€‰æ‹©ä¿å­˜è·¯å¾„")
            return False
        if not self.urls:
            messagebox.showerror("é”™è¯¯", "Excelæ–‡ä»¶ä¸­æ²¡æœ‰æ‰¾åˆ°æœ‰æ•ˆçš„URL")
            return False

        try:
            count = int(self.download_count.get() or len(self.urls))
            if count &lt;= 0 or count &gt; len(self.urls):
                messagebox.showerror("é”™è¯¯", f"ä¸‹è½½æ•°é‡å¿…é¡»åœ¨1åˆ°{len(self.urls)}ä¹‹é—´")
                return False
            self.update_urls_display()
        except ValueError:
            messagebox.showerror("é”™è¯¯", "è¯·è¾“å…¥æœ‰æ•ˆçš„ä¸‹è½½æ•°é‡")
            return False

        return True

    def start_download(self):
        if not self.validate_inputs():
            return

        self.download_button.state(['disabled'])
        Thread(target=self.download_thread).start()

    def download_thread(self):
        try:
            count = int(self.download_count.get() or len(self.urls))
            proxy = self.proxy.get()

            def progress_callback(progress, status):
                self.root.after(0, self.update_progress, progress, status)

            results = batch_download(
                self.urls[:count],
                self.save_path.get(),
                self.resolution.get(),
                proxy=proxy,
                progress_callback=progress_callback
            )

            success_count = sum(1 for r in results if r['çŠ¶æ€'] == 'æˆåŠŸ')
            messagebox.showinfo("å®Œæˆ", f"ä¸‹è½½å®Œæˆï¼æˆåŠŸ: {success_count}/{len(results)}")

        except Exception as e:
            messagebox.showerror("é”™è¯¯", f"ä¸‹è½½è¿‡ç¨‹ä¸­å‡ºé”™: {str(e)}")

        finally:
            self.download_button.state(['!disabled'])
            self.status_label.config(text="å°±ç»ª")
            self.progress_label.config(text="")
            self.progress['value'] = 0


def main():
    root = tk.Tk()
    app = YoutubeDownloaderUI(root)
    root.mainloop()


if __name__ == "__main__":
    main()</pre>

<h1>å¼€å‘è¿‡ç¨‹ï¼ˆå¾…è¡¥å……ï¼Œåœ¨å†™äº†åœ¨å†™äº†ï¼‰</h1>

<h1>å°¾å£°</h1>
<p>ä¹‹æ‰€ä»¥å¼€å‘è¿™ä¸¤ä¸ªè½¯ä»¶ï¼Œä¸€å¼€å§‹æ˜¯å› ä¸ºæˆ‘å­¦å®Œäº†AIç¼–ç¨‹èˆªæµ·æ‰‹å†Œï¼ŒåŒæ—¶é€šè¿‡åœˆå‹ä»¬å‘ç°cursorçš„å¦™å¤„ï¼Œæ‰“ç®—ç”¨cursorå¼€å‘å‡ ä¸ªè½¯ä»¶ç»ƒç»ƒæ‰‹ï¼Œç»“æœæ•ˆæœè¿˜ä¸é”™</p>

<p>å¼€å‘å®Œä¹‹åï¼Œä¸€å¼€å§‹æ˜¯è›®æ¿€åŠ¨çš„ï¼Œåœ¨ç”Ÿè´¢è¿˜ç«‹äº†flagï¼Œè¦åˆ†äº«ç»™åœˆå‹ä»¬ä¸€èµ·ç”¨</p>
<p><img src="img/efa32ad387355ac037d3b99db5e2bfb7.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/FmeAbRM5co00Nzxtk6lc0i4ynVN/"/></p>

<p>ä½†åé¢çœ‹åˆ°å¾ˆå¤šåœˆå‹åˆ†äº«cursorçš„æ•™ç¨‹ï¼Œæ„Ÿè§‰è‡ªå·±å†åˆ†äº«å¼€å‘è¿‡ç¨‹çš„è¯å°±æœ‰ç‚¹é‡å¤ï¼Œå°±æ²¡æœ‰åŠ¨åŠ›äº†å“ˆå“ˆå“ˆ</p>

<p>è½¯ä»¶ä¸€å¼€å§‹æ˜¯åªå†™äº†pythonè„šæœ¬ï¼Œæ²¡æœ‰å°è£…ï¼Œå¦‚æœåˆ†äº«ç»™å¤§å®¶ç”¨çš„è¯ï¼Œè‚¯å®šä¸èƒ½é‚£ä¹ˆç®€é™‹ï¼Œè€Œä¸”åªç»™pythonè„šæœ¬çš„è¯ï¼Œä¸äº†è§£ç¼–ç¨‹çš„åœˆå‹ç”¨èµ·æ¥å°±ä¼šæ¯”è¾ƒå›°éš¾</p>

<p>ä½†ä¸€æƒ³åˆ°è¦ç»§ç»­å¼€å‘UIç•Œé¢ï¼Œè¦ä¼˜åŒ–æ‰“åŒ…ï¼Œæ„Ÿè§‰å¤æ‚ï¼Œå°±æƒ³å·æ‡’äº†ï¼ˆbushiï¼‰</p>

<p>å¹¸å¥½æœ‰ å½­å“¥@è€å½­  çš„ç£ä¿ƒï¼Œä»Šå¤©è¶ç€æœ‰ç©ºå°±å…‰é€Ÿä¼˜åŒ–å°è£…+å†™å¸–å­åˆ†äº«</p>
<p><img src="img/bacb3763b7a0a63156488daa9f1510eb.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/DFdubx5CtoF9ZbxcgyQcfeYknjf/"/></p>

<p>å½“ç„¶ï¼Œä¸ºäº†é¿å…é‡å¤ï¼Œè¿™ç¯‡æ–‡ç« ä¼šä»¥ä»¥å·¥å…·åˆ†äº«ä¸ºä¸»ï¼Œå¼€å‘è¿‡ç¨‹åé¢è¡¥å……ï¼ˆcursoræŒ‰é¡¹ç›®å¼€èŠå¤©ï¼Œå¯¼è‡´å¾ˆå¤šèŠå¤©æˆ‘æ‰¾ä¸åˆ°äº†å“ˆå“ˆå“ˆï¼‰ï¼Œå…ˆæŠŠå·¥å…·åˆ†äº«ç»™å¤§å®¶ä½¿ç”¨</p>

<p>å¦‚æœè¿™ä¸¤ä¸ªè½¯ä»¶å¯¹å¤§å®¶æœ‰å¸®åŠ©çš„è¯ï¼ŒæœŸå¾…å¤§å®¶çš„åé¦ˆ~</p>
<p>ç‚¹èµã€è¯„è®ºæˆ–è€…æä¾›ä¼˜åŒ–å»ºè®®éƒ½å¯ä»¥ï¼ï¼ï¼</p>
<h1>æ„Ÿè°¢</h1>
<p>æ„Ÿè°¢ å½­å“¥@è€å½­  çš„ç£ä¿ƒï¼Œä¸ç„¶è¿™ä¸ªå¸–å­å¯èƒ½é¥é¥æ— æœŸå“ˆå“ˆå“ˆ</p>

<p>æ„Ÿè°¢ é©¬å“¥@è€é¦¬ğŸå†…å®¹å‡ºæµ· åœ¨ è¿™ç¯‡æ–‡ç« ä¸­åˆ†äº«çš„æ–¹æ³•ï¼ˆè°ƒç”¨Youtubeå®˜æ–¹apié‡‡é›†æ•°æ®ï¼‰ï¼Œæˆ‘ç¬¬ä¸€ä¸ªè½¯ä»¶çš„æ€è·¯å°±æ˜¯æ¥è‡ªäºé©¬å“¥</p>

<p>æ„Ÿè°¢ @é˜¿ç´« åˆ†äº«çš„ å’Œ @Time åˆ†äº«çš„ã€Š0ä»£ç AIç¼–ç¨‹é‡å¡‘ä½ çš„ç¼–ç¨‹ä½“éªŒï¼šCursorä½¿ç”¨æ•™ç¨‹ã€‹ï¼Œæˆ‘è‡ªå·±æ‘¸ç´¢cursorå°±æ˜¯çœ‹çš„è¿™ä¸¤ä¸ªæ•™ç¨‹å“ˆå“ˆå“ˆ</p>

<p>æ„Ÿè°¢ @é˜¿å¨ å‘Šè¯‰æˆ‘pythonæœ‰ä¸€ä¸ªä¸‹è½½youtubeè§†é¢‘çš„yt_dlpåº“ï¼Œä¸ç„¶æˆ‘å¯èƒ½å°±å¼€å‘åœ¨çº¿ä¸‹è½½ç½‘ç«™å»äº†</p>

<p>æ„Ÿè°¢ @çº¢å“¥Frank åˆ†äº«çš„Youtubeåœ¨çº¿ç½‘ç«™å¼€å‘è¿‡ç¨‹ï¼Œæˆ‘ä¸€å¼€å§‹ä»¥ä¸ºyoutubeçš„è§†é¢‘åˆ†è¾¨ç‡åªæœ‰1080pï¼Œçœ‹äº†çº¢å“¥çš„å¸–å­æ‰çŸ¥é“æœ‰1440pä»¥åŠæ›´é«˜</p>



