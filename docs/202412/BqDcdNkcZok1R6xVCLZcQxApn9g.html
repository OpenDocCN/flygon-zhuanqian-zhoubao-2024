<h1>用一个RPA脚本搞定小绿书、小红书、公众号爆文的自动发布</h1>
<blockquote>来源：<a href="https://b121w2zgwyx.feishu.cn/docx/BqDcdNkcZok1R6xVCLZcQxApn9g">https://b121w2zgwyx.feishu.cn/docx/BqDcdNkcZok1R6xVCLZcQxApn9g</a></blockquote>
<p>之前的文章</p>
<p>脚本实现了，自动调用coze工作流，生成文章，并自动发布公众号爆文和小绿书的功能。不过经过使用和大家的反馈发现以下问题：</p>
<p>1、脚本分成了多个导致安装脚本相对麻烦</p>
<p>2、运行过程中缺乏提示信息，导致排查错误困难</p>
<p>3、还有就是希望可以自动勾选原创</p>
<p>4、希望加上小红书的发布，这样小绿书素材也可以发布到小红书</p>

<p>我觉得都很有道理，所以就安排上了，经过我最新的合并和开发，我将之前的所有脚本合并成了一个，目前这个脚本可以实现以下功能：</p>
<p>1、自动调用小红书改写小绿书工作流</p>
<p>2、自动调用公众号coze改写工作流</p>
<p>3、新增了服务号的发布兼容</p>
<p>4、新增了小红书的发布兼容</p>
<p>5、新增了自动勾选原创（公众号文章的）</p>
<p>6、coze工作流新增了更通用的总结小绿书生成工作流（适用多个领域的内容生成）</p>

<p>接下来，来说一下这个脚本的安装和使用吧</p>
<h1>一、首先，飞书申请与权限配置。</h1>
<p>请看  ，飞书这个配置要仔细看，没做好，工具无法使用</p>
<h1>二、脚本工具环境配置</h1>
<h2>1、比特浏览器安装</h2>
<p>https://www.bitbrowser.cn/ 没什么特别说明的，直接安装就是了</p>
<h2>2、比特浏览器配置</h2>
<h3>①、打开比特浏览器，做个基础配置</h3>
<p>点击系统配置=》找到文件下载目录配置 改成你想要的目录</p>

<p><img src="img/7a227411e4eb49c5dd16adbdbc4fbad0.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/EtTjbzFaioEhE7xxPcucjRUin9b/"/></p>

<p>这个目录是后面下载图片时要用到的。</p>
<h3>②、导入rpa脚本</h3>
<p>现在脚本合并了，只需要安装以下脚本</p>

<p>下载脚本之后，然后, 打开比特浏览器=》 点击 “RPA自动化” =》进入流程设计</p>
<p><img src="img/a259493f99d5044bd6b6370b06322419.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/WD3Sb0WrIobyYsxO9i9cEaZTnCh/"/></p>

<p>浏览器会初始化，并打开一个用于调试的RPA窗口，以及自带安装好的Automa 插件。</p>

<p><img src="img/3ed4caeae03ab4bf071b7cd863d7c2e3.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/LB7CbT0roodOHxxayXZc8wLAndc/"/></p>

<p>打开automa窗口，进入工作流页面=》点击下拉标志=》点击导入工作流，将前面下载的工作流导入</p>

<p><img src="img/1a8453c380e0cfe24ae652573e08fddf.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/GcRgbbpAYoima1xgS9jc2cLfn0f/"/></p>
<h2>3、排版工具的准备</h2>
<p>我们的脚本使用了一个叫做墨滴的markdown排版工具，AI生成的内容会自动生成markdown格式。我们通过这个工具进行转换排版，并发布公众号。</p>
<h3>①、登录墨滴</h3>
<p>https://www.mdnice.com/  没有账号的去注册一个；</p>
<h3>②、新建一个文章页面</h3>
<p><img src="img/dc29eb261e15ca92bee36b1394b300ab.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/QTdHbeYt0ogrCSx85ejcmEVenye/"/></p>
<p>标题随便输入就行了</p>
<p><img src="img/2a60465ec4b19b92c0ebd05749d8aa7a.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/V5qJbE40Hohj9yxHBticFM92n2e/"/></p>
<h3>③、设置一个自己喜欢的主题排版</h3>
<p>在内容中，随便输入一些内容，如图：</p>
<p><img src="img/f3360835cd084b875b0d7022221f8551.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/O5nibdOTpozgWyxvirxcOsrrn7f/"/></p>
<p>接着我们选择一个我们喜欢的主题，后续文章就会使用这个主题排版</p>
<p><img src="img/5d4216159d54b0308c6dbc934483e816.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/PNc1bbDWHoeXqkxZkHYcuUxnnHS/"/></p>
<p>④、保存一下当前文章的链接地址</p>
<p>接下来我们保存一下，然后将这个文章地址复制下来，后续要配置到脚本当中，复制完就可以关闭了。</p>
<p><img src="img/d7792f0bd5c191a1d8b051dfed39e279.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/TrrJbjIChockv2xVuMAcVbrHnsc/"/></p>
<h2>4、rpa配置</h2>
<h3>①、拷贝我最新的飞书模版</h3>
<p>进入我的飞书表格</p>
<p>创建一下副本</p>
<p><img src="img/af655555fb3f16b0cc88babbb4b00ded.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/BfY6btW2LoeOI0x3Hc7csDmqnVb/"/></p>
<p>然后获取飞书表格链接，注意了，每个表单点击一下，链接都不一样的，后面的配置会用到，一定要对应正确的表格链接</p>
<p><img src="img/00813b5fd3cfbd5e76f8b449c6c2f0e4.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/W9PjbS7ZioouIkxEoWpcoZFpnLf/"/></p>
<h3>②、脚本默认配置</h3>
<p>接下来，我们开始进行脚本的基本配置，每个脚本都要配置哦。我们首先打开比特浏览器=》 点击 “RPA自动化” =》进入流程设计。</p>
<p>然后进入工作流页面找到我们的刚刚导入的脚本，点击进入脚本编辑页面。找到触发器的后面一个节点叫做“插入数据”，我们双击“插入数据”，（看下图，我有做了标注）然后点击左边的 “insert data”按钮,修改里面的参数；</p>
<p><img src="img/711a6ef337d28e5c3da4a1c6b897189f.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/O8I6bX4Z6o4GtoxX7Ugc9UpKncb/"/></p>
<p>这个脚本需要配置的参数如下：</p>
<table><tr><th>app_id  </th><th>填你前面飞书得到的app_id;</th></tr><tr><td>app_secret </td><td>填你前面飞书得到的app_secret ;</td></tr><tr><td>xuanti_sheet_url</td><td>填你的选题库表单的url</td></tr><tr><td>daifabu_sheet_url </td><td>填你的飞书待发布表单的url（前面有说明过了）</td></tr><tr><td>yifabu_sheet_url </td><td>填你的飞书已发布表单的url</td></tr><tr><td>zhanhao_sheet_url </td><td>填你的飞书账号配置表单的url</td></tr><tr><td>xhs_sheet_url</td><td>小红书爬取的链接</td></tr><tr><td>save_draft   </td><td>这个填1 代表发布到草稿箱，填0代表直接发布（待测试完善）</td></tr><tr><td>download_path  </td><td>这个填前面第2步，比特浏览器的下载目录就行了</td></tr><tr><td>markdown_theme</td><td>排版主题文章链接，这里填写第3步墨滴排版配置好的地址</td></tr><tr><td>user_name</td><td>账号用户名（请查看 ）</td></tr><tr><td>parent_code</td><td>上级邀请码（请查看 ）</td></tr><tr><td>is_modi</td><td>是否开启排版，不开启则不会进行排版</td></tr><tr><td>lingyu</td><td>随便填预留的</td></tr></table>
<h3>③、调试脚本（请调试没问题之后再进行绑定到窗口）</h3>
<p>每个脚本配置完成之后，请先点保存，再运行调试。调试没问题之后，再进行下一个脚本。</p>
<p><img src="img/183510ec666279ce2d957f75deaa508d.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/Gqtybiegvos3m9xWV3JcyP4wnFc/"/></p>
<h3>④、调试注意项</h3>
<p>因为脚本合并之后，一次执行，其实会并发打开三个页面，每个页面都做会自动化执行任务。但是呢活动页面只会停留在公众号的页面，大家记得人工点开其余两个页面，看看运行的情况。（而且，第一次需要登陆，一定要注意检查一下，没问题之后，以后就不必太关注了）</p>
<p>如何看有没有问题？</p>
<p>点击运行之后请点击这个日志</p>
<p><img src="img/9a37fd8616abfff8ba386dbd9c273eb8.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/Z8cObN3iEoTjW2xK6UqcIqPinnc/"/></p>
<p>脚本运行失败一般都会出现如下报错：</p>
<p><img src="img/161108187e659789a192d844cac29fae.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/Lr9Qb9v8ToXDMaxFEAUcenEbnqb/"/></p>
<p>请根据报错问题调整，实在不会调整，请点开详情，找到红色的报错的位置，把具体信息反馈到交流群，如：</p>
<p><img src="img/3f44f617ae1c957082514c47699760f5.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/K6oAba2YCo5GUfx7A3KcP4phnvH/"/></p>
<h3>④、绑定窗口后，记得授予权限</h3>
<p>如何绑定窗口使用，这个之前的教程文档里有可以去查看，这里不再重复。</p>
<p>在 二、4、将rpa配置到比特浏览器，以实现定时执行，和ip隔离</p>
<p>请大家一定要注意，如果绑定到窗口执行，第一次记得打开窗口里面的脚本进行权限授予</p>
<p>首先，打开窗口，如下图，进入浏览器窗口，打开窗口：</p>
<p><img src="img/9ddef9620b20f4bd81241af56a2a0e4a.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/LWbCbXrGco0RdHxJV5NcaBATnFf/"/></p>
<p>从窗口里打开窗口的automa，然后找到导入的脚本。</p>
<p><img src="img/246bf6b91149f3f69c76647881274b1e.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/T8CUbRzSJogcC0xwz6NcGGErnJc/"/></p>
<p>对以下三个节点进行授予权限，我已经特意给拉出来了，只要在这个地方授予了正常就能用了：</p>
<p><img src="img/c807834929e6fc1193a4016f20ba7c0d.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/PrTubuNr1ocwmDxEaY8cH9yPnVf/"/></p>
<h1>三、脚本使用</h1>
<p>目前脚本实现的功能说明，我已经整理成文档，大家可以查看：</p>

<p>这里重点说一下新增的功能注意点：</p>
<p><img src="img/7e3193a9acf771f8dee1b1e35a4166ca.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/BHPObZo8noXI61xD7rpctXsRnAf/"/></p>
<p>账号配置表格，新增了两列，使用说明如下：</p>
<p>原创作者：如果填写了原创作者则表明，公众号图文需要声明原创，如果不需要，则留空</p>
<p>定时发布：填写定时发布，则会定时发布，如果不填则直接发布（定时发布暂时只针对小红书）</p>
<h1>四、常见问题</h1>
<h2>1、脚本成功执行，但是调用coze智能体失败</h2>
<p><img src="img/e7392722acb85269b4c8a2c98aab464c.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/XOP6bIx6qoStbhxoldGc481wnwh/"/></p>
<p>请检查，脚本配置里的xuanti_sheet_url  是否确实是选题库的对应链接。并且选题库里面有最新的选题需要生成。并且按照要求配置信息（选题库里的“最后一次生成时间”为空表示需要ai进行生成）</p>
<h2>2、脚本成功执行，但是公众号没有执行自动发布</h2>
<p>请检查，脚本配置里的 daifabu_sheet_url  是否确实是待发布表格的链接。并且待发布里面是否有内容需要发布（待发布标题不在已发布表格里，就说明需要发布）</p>
<p>好了，本次的分享就到这里了，大家如果有什么使用上的问题和建议，欢迎找我一起交流</p>
<h2>3、提取内容和图片名失败</h2>
<p><img src="img/0098e109f37fbd51617555533b92cfdf.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/PD9NbZTjtocRXfx5V8mcWdi0nDe/"/></p>
<p>出现以上的错误，基本是待发布没有文章内容，或者待发布文章内容的领域类型与当前发布账号的领域类型对应不上，所以，无内容可发。请检查配置中的待发布文章表格链接，或者领域类型是否正确！</p>
